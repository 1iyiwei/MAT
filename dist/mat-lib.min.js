!function e(t,r,n){function i(o,s){if(!r[o]){if(!t[o]){var u="function"==typeof require&&require;if(!s&&u)return u(o,!0);if(a)return a(o,!0);var c=new Error("Cannot find module '"+o+"'");throw c.code="MODULE_NOT_FOUND",c}var l=r[o]={exports:{}};t[o][0].call(l.exports,function(e){var r=t[o][1][e];return i(r?r:e)},l,l.exports,e,t,r,n)}return r[o].exports}for(var a="function"==typeof require&&require,o=0;o<n.length;o++)i(n[o]);return i}({1:[function(e,t,r){"use strict";function n(e,t,r,n,i,a,c){this.draw=e,this.drawStuff=t,this.run=r,this.setViewBox=n,this.Vector=i,this.beziersToDraw=a,this.shouldDrawSATTree=c,this.elems=[],this.elemCount=0,this.twoProngs=[],this.threeProngs=[],this.nProngs=[],this.cpCalcs=0,this.rootsSkipped=0,this.rootsNotSkipped=0,this.skipped={stage0:0,stage1:0,stage2:0,stage3:0},this.notSkipped={stage0:0,stage1:0,stage2:0,stage3:0},this.generated={nodeHash:{},cpHash:{},cpArr:[]},this.mat,this.sat,this.state={selectedCp:void 0},this.fs={threeProng:{drawSpokes:function(e){return u(this,e)}},cp:{log:m.log(this),draw:m.draw(this),selectNext:m.next(this),selectPrevOnCircle:m.prevOnCircle(this)}},this.deltasToNiceStr=s,this.pointsToNiceStr=o}function i(e){return e.map(function(e){return e.item.key})}function a(e){return e[0].toFixed(5)+", "+e[1].toFixed(5)}function o(e){return e.map(a)}function s(e){return e.map(i)}function u(e,t){var r=e.nProngs[t],n=r.threeProng;console.log(n);var i=n.circle.center,a=n.ps;e.draw.line([a[0],i],"thin5 red"),e.draw.line([a[1],i],"thin5 red"),e.draw.line([a[2],i],"thin5 red")}function c(e,t){var r=Number.POSITIVE_INFINITY,n=void 0,i=!0,a=!1,o=void 0;try{for(var s,u=e[Symbol.iterator]();!(i=(s=u.next()).done);i=!0){var c=s.value,l=f.distanceBetween(c,t);l<r&&(r=l,n=c)}}catch(e){a=!0,o=e}finally{try{!i&&u.return&&u.return()}finally{if(a)throw o}}return n}var l=e("./geometry/classes/circle.js"),v=e("./mat/functions/get-nodes-as-array.js"),h=(e("./linked-loop/list-node.js"),e("./linked-loop/linked-loop.js")),f=e("./vector/vector.js"),p=e("./geometry/classes/point-on-shape.js"),m={log:function(e){return function(){var t=e.state.selectedCp,r=t.item;console.log(t),console.log(p.toString(r.pointOnShape))}},next:function(e){return function(){e.state.selectedCp=e.state.selectedCp.next}},prevOnCircle:function(e){return function(){e.state.selectedCp=e.state.selectedCp.prevOnCircle}},draw:function(e){return function(){e.draw.crossHair(e.state.selectedCp.item,"blue thin5 nofill",1)}}};n.prototype.drawSATTree=function(e){function t(e,n){var i="5"===e?"M":e;"M"===i&&(i="M-"+n.size,r.push(n.size));var a={text:{name:i},children:[]};for(var o in n){var s=n[o];a.children.push(t(o,s))}return a}var r=[];({chart:{container:"#mat-tree"},nodeStructure:t("root",e)});r.sort(function(e,t){return e-t})},n.prototype.getDistanceBetween=function(){for(var e=arguments.length,t=Array(e),r=0;r<e;r++)t[r]=arguments[r];return f.distanceBetween(t)},n.prototype.drawDot=function(e,t,r){return this.draw.dot(e,t,r)},n.prototype.testNProng_1=function(){this.setViewBox([65,287,85,72])},n.prototype.test2Prong_2=function(){this.traceNProng(13),this.drawDot([118.83,333.59],.3,"green"),this.drawDot([122.26,332.36],.3,"green"),this.drawDot([103.9345546632512,292.8475727546303],.3,"green"),this.drawDot([102.28082651515273,293.73728721662496],.3,"green"),this.drawDot([102.28082651515273,293.73728721662496],.1,"yellow"),this.drawDot([118.83,333.59],.1,"yellow")},n.prototype.test2Prong_1=function(){this.setViewBox([126,201,179,146]),d.trace2ProngConvergence(46);$timeout()},n.prototype.drawBezierArcs=function(e){var t=(this.shape,beziers.nodeArr),r=t[e];console.log(r)},n.prototype.logBezierInterfaceAngles=function(){var e=bezier.tangent(1),t=node.next.item.tangent(0),r=f.cross(e,t);"tangents (degrees): "+Util.radToDeg(Math.asin(r)).toFixed(8)},n.prototype.remove=function(e){this.elems[e].remove()},n.prototype.log2ProngDelta=function(e){var t=this.twoProngs[e].delta;console.log(t)},n.prototype.log2Prong=function(e){var t=this.twoProngs[e];console.log(t)},n.prototype.draw2ProngNormal=function(e){if(void 0===e)for(var t=0;t<this.twoProngs.length;t++)this.draw2ProngNormal(t);var r=this.twoProngs[e];r&&this.draw.line([r.y,r.x],"thin10 blue")},n.prototype.log2ProngDeltaBasic=function(e){var t=this.twoProngs[e].delta,r=function(e){return{bez:e.item.pointOnShape.bezierNode.item.indx,t:e.item.pointOnShape.t,order:e.item.pointOnShape.order}};console.log(r(t[0])),console.log(r(t[1]))},n.prototype.traceNProng=function(e){var t=this.nProngs[e],r=t.dbgInfo,n=r.cs;console.log(t);var i=!0,a=!1,o=void 0;try{for(var s,u=n[Symbol.iterator]();!(i=(s=u.next()).done);i=!0){var c=s.value;this.draw.dot(c.x,.2,"cyan"),c.radius=c.ccr,c.center=c.x,this.draw.circle(c,"cyan thin20 nofill")}}catch(e){a=!0,o=e}finally{try{!i&&u.return&&u.return()}finally{if(a)throw o}}},n.prototype.logNProngDelta=function(e){var t=this.nProngs[e];console.log(t.deltas)},n.prototype.logNProngDeltaBasic=function(e){for(var t=this.nProngs[e],r=function(e){return{bez:e.item.pointOnShape.bezierNode.item.indx,t:e.item.pointOnShape.t,order:e.item.pointOnShape.order}},n=0;n<t.deltas.length;n++){var i=t.deltas[n];console.log(r(i[0]),r(i[1]))}},n.prototype.testNProng_2=function(){this.setViewBox([68,290,85,56]),d.draw2ProngNormal(41),d.draw2ProngNormal(42),d.logNProngDeltaBasic(0),$timeout()},n.prototype.testNProng_3=function(){this.run(),this.setViewBox([10,286,84,90]),d.logNProngDeltaBasic(1),$timeout()},n.prototype.highlightBeziers=function(e){var t=["red","green","blue"],r=Util.rangeStrToIndxArray(e),n=0,i=!0,a=!1,o=void 0;try{for(var s,u=r[Symbol.iterator]();!(i=(s=u.next()).done);i=!0){var c=s.value;n++;var l=h.getByIndx(shape.beziers,c),v=t[n%t.length];draw.bezier(l,"nofill thin20 "+v)}}catch(e){a=!0,o=e}finally{try{!i&&u.return&&u.return()}finally{if(a)throw o}}},n.prototype.drawSomeStuff=function(e){this.draw.looseBoundingBoxes(e,"thin2 brown nofill"),this.draw.tightBoundingBoxes(e,"thin2 black nofill");var t=this.beziersToDraw,r=h.getByIndx(e.beziers,t[0]),n=h.getByIndx(e.beziers,t[1]+1);this.draw.beziers(e,r,n)},n.prototype.trace2ProngConvergence=function(e,t){var r=void 0;if(t)for(var n=0,i=0;i<this.twoProngs.length;i++){var a=this.twoProngs[i];if(a.failed){if(e===n){r=i,console.log(r);break}n++}}else r=e;if(r){var o=this.twoProngs[r],s=(o.twoProng,!0),u=!1,c=void 0;try{for(var v,h=o.xs[Symbol.iterator]();!(s=(v=h.next()).done);s=!0){var d=v.value;this.draw.crossHair(d.x,"blue thin10 nofill");var p=new l(d.x,f.distanceBetween(d.x,d.y));this.draw.circle(p,"blue thin10 nofill"),this.draw.crossHair(d.z,"yellow thin10 nofill",2)}}catch(e){u=!0,c=e}finally{try{!s&&h.return&&h.return()}finally{if(u)throw c}}return console.log(o.xs.map(function(e){return{x:e.x,y:e.y,z:e.z,d:f.squaredDistanceBetween(e.y,e.z),t:e.t}})),this.draw2ProngNormal(r),"Failed: "+o.failed}},n.prototype.logNearestNProng=function(e,t){var r=this,n=v(this.mat),i=n.filter(function(e){return t?2===e.matCircle.cpNodes.length:2!==e.matCircle.cpNodes.length}).map(function(e){return e.matCircle.circle.center}),a=c(i,e),o=p.makeSimpleKey(a),s=this.generated.nodeHash[o],u=s.matNode,h=u.matCircle,f=h.cpNodes.map(function(e){return r.generated.cpHash[e.item.simpleKey]});console.log(s),console.log(f),console.log(f.map(function(e){if(e)return e.visitedPointsArr.map(function(e){return e.map(function(e){return{cpNode:e,cp:e.item,pos:e.item.pointOnShape,0:e.item.pointOnShape[0],1:e.item.pointOnShape[1]}})})})),console.log(f.map(function(e){if(e)return e.visitedPointsArr.map(function(e){return e.map(function(e){return MatLib.PointOnShape.toString(e.item.pointOnShape)})})}));new l(h.circle.center,h.circle.radius||1);if(t){for(var d=void 0,m=0;m<this.twoProngs.length;m++){var g=this.twoProngs[m],y=g.twoProng,b=y.item.matCircle.circle.center;if(a[0]===b[0]&&a[1]===b[1]){d=m;break}}d&&this.trace2ProngConvergence(d)}},t.exports=n},{"./geometry/classes/circle.js":5,"./geometry/classes/point-on-shape.js":6,"./linked-loop/linked-loop.js":14,"./linked-loop/list-node.js":15,"./mat/functions/get-nodes-as-array.js":30,"./vector/vector.js":43}],2:[function(e,t,r){"use strict";function n(e,t){var r=e.dullCornerHash,n=s.makeSimpleKey(t),i=r[n]||null;return i}function i(e){for(var t in a.pointType)if(a.pointType[t]===e)return t}var a=e("../../mat-constants.js"),o=e("../../vector/vector.js"),s=function e(t,r,n,i,a,o,s){this.bezierNode=r,this.t=n,this.type=i,this.order=a,this.osculatingCircle=o,this.sharpness=s,this.simpleKey=e.makeSimpleKey(t),this[0]=t[0],this[1]=t[1],this.key=e.toString(this)};s.setPointOrder=function(e,t,r,i){var a=n(e,r);if(a){var u=a.bezier,c=u.tangent(1),l=[c[1],-c[0]],v=o.toUnitVector(o.fromTo(r,t.center)),h=-o.dot(l,v);return r.order=h,r.key=s.toString(r),i&&i.drawStuff,r.order}},s.shift=function(e,t){if(t<=-1||t>=1)throw"Δt not in range (-1, 1); Δt was "+t;var r=e.bezierNode,n=e.t+t;return n<0?(n+=1,r=r.prev):n>1&&(n-=1,r=r.next),new s(r.item.evaluate(n),r,n,a.pointType.standard,0)},s.cloneAndAdv=function(e){return new s(e.bezierNode.item.evaluate(e.t),e.bezierNode,e.t,e.type,e.order+e.order/111111111111)},s.split=function(e,t){return[s.shift(e,-t),s.shift(e,+t)]},s.splitForward=function(e,t){return[e,s.shift(e,2*t)]},s.splitBack=function(e,t){return[s.shift(e,-2*t),e]},s.toString=function(e){return""+e[0]+", "+e[1]+"|"+e.order+"|"+e.type},s.toHumanString=function(e){var t=""+e[0]+", "+e[1]+" | bz: "+e.bezierNode.item.indx+" | t: "+e.t+" | ord: "+e.order+" | ";return t+i(e.type)},s.makeSimpleKey=function(e){return""+e[0]+", "+e[1]},s.compare=function(e,t){var r=e.bezierNode.item.indx-t.bezierNode.item.indx;return 0!==r?r:(r=e.t-t.t,0!==r?r:e.order-t.order)},t.exports=s},{"../../mat-constants.js":17,"../../vector/vector.js":43}],3:[function(e,t,r){"use strict";var n=function(e,t,r,n,i,a,o){this.circle=e,this.startpoint=t,this.endpoint=r,this.sin_angle1=n,this.sin_angle2=a,this.cos_angle1=i,this.cos_angle2=o};t.exports=n},{}],4:[function(e,t,r){"use strict";function n(e,t){function r(e){var t=V(e),r=L(e);return Math.sqrt(t*t+r*r)}function c(){if(Z)return Z;var e=s(r,[0,1]);return Z=e,e}function l(e){var t=V(e),r=L(e),n=Y(e),i=K(e),a=t*t+r*r;return(t*i-r*n)/Math.sqrt(a*a*a)}function v(e){var t=V(e),r=L(e),n=Y(e),i=K(e),a=t*t+r*r;return(t*i-r*n)/a}function h(e){var t=e||[0,1],r=""+t[0]+", "+t[1];if(X[r])return X[r];var n=s(function(e){return Math.abs(v(e))},t);return X[r]=n,n}function f(){if(W)return W;var e=s(v,[0,1]);return W=e,e}function d(e){var t=e*e,r=1-e,n=t*O,i=t*B,a=2*e-3*t,o=(3*e-1)*r,s=r*r,u=3*(n+a*T-o*_-s*I),c=3*(i+a*z-o*P-s*N),l=6*(e*B-(3*e-1)*z+(3*e-2)*P+r*N),v=6*(e*O-(3*e-1)*T+(3*e-2)*_+r*I);return 4*(u*(B-3*z+3*P-N)-c*(O-3*T+3*_-I))*Math.pow(c*c+u*u,1.5)-(u*l-v*c)*(2*l*c+2*v*u)*Math.sqrt(c*c+u*u)}function p(e){return 0===e?[I,N]:1===e?[O,B]:[k(e),R(e)]}function m(e){var t=V(e),r=L(e),n=Math.sqrt(t*t+r*r);return[t/n,r/n]}function g(e){var t=m(e);return[t[1],-t[0]]}function y(){if($)return $;var t=b(),r=t[0][0],n=t[0][1],i=t[1][0],a=t[1][1],o=[t[0],[i,n],t[1],[r,a]];return $=u.rotateThenTranslatePoints(o,e[0],U,Q)}function b(){if(J)return J;var t=u.transform(e[0],function(e){return-e}),r=new n(u.translateThenRotatePoints(e,t,-U,Q),(void 0));return J=r.getBoundingBox()}function x(){if(ee)return ee;var e=[q,E],t=e.map(o.findQuadraticRoots01);t[0].push(0),t[0].push(1),t[1].push(0),t[1].push(1);for(var r=(t[0].map(k),t[1].map(R)),n=Number.POSITIVE_INFINITY,i=Number.NEGATIVE_INFINITY,s=0;s<t[0].length;s++){var u=k(t[0][s]);u>i&&(i=u,this.tAtMaxX=t[0][s]),u<n&&(n=u)}return ee=[[n,a.min(r)],[i,a.max(r)]]}this.indx=t;var w=i(e,4),j=i(w[0],2),I=j[0],N=j[1],S=i(w[1],2),_=S[0],P=S[1],C=i(w[2],2),T=C[0],z=C[1],M=i(w[3],2),O=M[0],B=M[1],A=[O-3*T+3*_-I,3*T-6*_+3*I,3*_-3*I,I],D=[B-3*z+3*P-N,3*z-6*P+3*N,3*P-3*N,N],k=o.evaluate(A),R=o.evaluate(D),q=o.differentiate(A),E=o.differentiate(D),V=o.evaluate(q),L=o.evaluate(E),F=o.differentiate(q),H=o.differentiate(E),Y=o.evaluate(F),K=o.evaluate(H),G=Math.sqrt((O-I)*(O-I)+(B-N)*(B-N)),U=(B-N)/G,Q=(O-I)/G,Z=void 0,X={},W=void 0,$=null,J=null,ee=void 0;this.tAtMaxX=void 0,this.bezierPoints=e,this.tangent=m,this.normal=g,this.getBoundingBox=x,this.getBoundingBoxTight=y,this.getTotalAbsoluteCurvature=h,this.getTotalCurvature=f,this.getCurveLength=c,this.κ=l,this.dκ=d,this.evaluate=p}var i=function(){function e(e,t){var r=[],n=!0,i=!1,a=void 0;try{for(var o,s=e[Symbol.iterator]();!(n=(o=s.next()).done)&&(r.push(o.value),!t||r.length!==t);n=!0);}catch(e){i=!0,a=e}finally{try{!n&&s.return&&s.return()}finally{if(i)throw a}}return r}return function(t,r){if(Array.isArray(t))return t;if(Symbol.iterator in Object(t))return e(t,r);throw new TypeError("Invalid attempt to destructure non-iterable instance")}}(),a=e("../../utils.js"),o=e("../../polynomial/polynomial.js"),s=e("../../numerical/functions/gaussian-quadrature.js"),u=e("../../vector/vector.js");n.splitAt=function(e,t){var r=e.bezierPoints,a=i(r,4),o=i(a[0],2),s=o[0],u=o[1],c=i(a[1],2),l=c[0],v=c[1],h=i(a[2],2),f=h[0],d=h[1],p=i(a[3],2),m=p[0],g=p[1],y=1-t,b=t*t,x=b*t,w=y*y,j=w*y,I=[[s,u],[t*l+y*s,t*v+y*u],[b*f+2*y*t*l+w*s,b*d+2*y*t*v+w*u],[x*m+3*y*b*f+3*w*t*l+j*s,x*g+3*y*b*d+3*w*t*v+j*u]],N=[I[3],[b*m+2*t*y*f+w*l,b*g+2*t*y*d+w*v],[t*m+y*f,t*g+y*d],[m,g]];return[new n(I),new n(N)]},t.exports=n},{"../../numerical/functions/gaussian-quadrature.js":36,"../../polynomial/polynomial.js":39,"../../utils.js":42,"../../vector/vector.js":43}],5:[function(e,t,r){"use strict";function n(e,t){this.center=e,this.radius=t}n.scale=function(e,t){return new n(e.center,e.radius*t)},t.exports=n},{}],6:[function(e,t,r){"use strict";function n(e,t){var r=e.dullCornerHash,n=s.makeSimpleKey(t),i=r[n]||null;return i}function i(e){for(var t in a.pointType)if(a.pointType[t]===e)return t}var a=e("../../mat-constants.js"),o=e("../../vector/vector.js"),s=function e(t,r,n,i,a,o,s){this.bezierNode=r,this.t=n,this.type=i,this.order=a,this.osculatingCircle=o,this.sharpness=s,this.simpleKey=e.makeSimpleKey(t),this[0]=t[0],this[1]=t[1],this.key=e.toString(this)};s.setPointOrder=function(e,t,r,i){var a=n(e,r);if(a){var u=a.bezier,c=u.tangent(1),l=[c[1],-c[0]],v=o.toUnitVector(o.fromTo(r,t.center)),h=-o.dot(l,v);return r.order=h,r.key=s.toString(r),i&&i.drawStuff,r.order}},s.shift=function(e,t){if(t<=-1||t>=1)throw"Δt not in range (-1, 1); Δt was "+t;var r=e.bezierNode,n=e.t+t;return n<0?(n+=1,r=r.prev):n>1&&(n-=1,r=r.next),new s(r.item.evaluate(n),r,n,a.pointType.standard,0)},s.cloneAndAdv=function(e){return new s(e.bezierNode.item.evaluate(e.t),e.bezierNode,e.t,e.type,e.order+e.order/111111111111)},s.split=function(e,t){return[s.shift(e,-t),s.shift(e,+t)]},s.splitForward=function(e,t){return[e,s.shift(e,2*t)]},s.splitBack=function(e,t){return[s.shift(e,-2*t),e]},s.toString=function(e){return""+e[0]+", "+e[1]+"|"+e.order+"|"+e.type},s.toHumanString=function(e){var t=""+e[0]+", "+e[1]+" | bz: "+e.bezierNode.item.indx+" | t: "+e.t+" | ord: "+e.order+" | ";return t+i(e.type)},s.makeSimpleKey=function(e){return""+e[0]+", "+e[1]},s.compare=function(e,t){var r=e.bezierNode.item.indx-t.bezierNode.item.indx;return 0!==r?r:(r=e.t-t.t,0!==r?r:e.order-t.order)},t.exports=s},{"../../mat-constants.js":17,"../../vector/vector.js":43}],7:[function(e,t,r){"use strict";function n(e,t){var r=[],n=!0,i=!1,a=void 0;try{for(var o,s=t[Symbol.iterator]();!(n=(o=s.next()).done);n=!0){var u=o.value,c=g.doesCircleIntersectShape(e,u.osculatingCircle,u);u.intersects=c,u.type!==N.pointType.dull?c?r.push(u):r.push(u):c?r.push(u):u.type===N.pointType.dull&&(c||r.push(u))}}catch(e){i=!0,a=e}finally{try{!n&&s.return&&s.return()}finally{if(i)throw a}}return r}function i(e){for(var t=new b([],function(e,t){return x.compare(e.item,t.item)}),r=new b([],(void 0)),n=void 0,i=void 0,a=0;a<e.length;a++){var o=e[a],s=o.pointOnShape;i=b.insert(r,o,i),s.type===N.pointType.dull?180*Math.acos(1-s.sharpness)/Math.PI>16&&(n=b.insert(t,o,n,i)):s.type===N.pointType.sharp?180*Math.acos(1-s.sharpness)/Math.PI>16&&(n=b.insert(t,o,n,i)):n=b.insert(t,o,n,i),i.coupledNode=n}return t}function a(e,t){var r=e.head,n=[],i=[];do{var a=r.item,o=a.pointOnShape;j.create(o.osculatingCircle,[r]);o.intersects?n.push(r):o.type===N.pointType.dull?i.push(r):o.type===N.pointType.osculating&&t&&(t.draw.dot(a,.2,"gray"),t.draw.dot(a.matCircle.circle.center,.5,"gray"),t.draw.circle(a.matCircle.circle,"gray thin10 nofill")),r.prevOnCircle=r,r.nextOnCircle=r,r=r.next}while(r!==e.head);for(var s=0;s<i.length;s++){var u=i[s];b.remove(e,u)}return n}function o(e,t){var r=e.head,n=void 0;do{n=!1;var i=[],a=r.coupledNode;do{var o=c([a.item,a.next.item]);i.push({cpNode:a,c:o}),a=a.next}while(a.coupledNode!==r.next);var l=u(i);r.totalCurvatures=i,r.totalCurvature=l;var v=180*l/Math.PI;if(v>t){for(var h=0,f=r.totalCurvature,d=void 0,p=0,m=void 0,g=0,y=void 0,x=Number.POSITIVE_INFINITY,w=0;w<i.length;w++){var j=i[w].c,I=j.totalCurvature+j.totalTurn;h+=I;i[w].cpNode;h<=f/2&&(p=w,g=h),!m&&h>f/2&&(m=w,y=h);var N=Math.abs(f/2-h);h>f/4&&h<3*f/4&&x>N&&(d=w,x=N)}if(void 0!==d){var S=i[d],_=b.insert(e,S.cpNode.next.item,r,S.cpNode.next);S.cpNode.next.coupledNode=_,r.totalCurvatures=r.totalCurvatures.slice(0,d+1),r.totalCurvature=u(r.totalCurvatures),n=!0}else{var P=i[p],C=i[m],T=P.cpNode,z=C.cpNode;P.c,P.cpNode.next,C.cpNode.next,s(T.item,z.item,g,y,f/2)}}n||(r=r.next)}while(r!==e.head)}function s(e,t,r,n,i){var a=i-r,o=e.pointOnShape,s=t.pointOnShape,u=o.bezierNode,c=s.bezierNode,l=u,v=0,h=0;do{var d=void 0;d=l!==c?Math.abs(f(l)):0;var p=void 0,m=[0,1];l===u&&(m[0]=o.t),l===c&&(m[1]=s.t),p=l.item.getTotalAbsoluteCurvature(m),v+=d,h+=p;var g=v+h;if(g>=a)break;l=l.next}while(l.prev!==c)}function u(e){for(var t=0,r=0;r<e.length;r++){var n=e[r].c;t+=n.totalTurn+n.totalCurvature}return t}function c(e){var t=d(e,2),r=t[0],n=t[1],i=r.pointOnShape,a=n.pointOnShape,o=i.bezierNode,s=a.bezierNode,u=o,c=0,l=0;do{var v=void 0;v=u!==s?Math.abs(f(u)):0;var h=void 0,p=[0,1];u===o&&(p[0]=i.t),u===s&&(p[1]=a.t),h=u.item.getTotalAbsoluteCurvature(p),c+=v,l+=h,u=u.next}while(u.prev!==s);return{totalTurn:c,totalCurvature:l}}function l(e,t,r){var n=!0,i=!1,a=void 0;try{for(var o,s=t[Symbol.iterator]();!(n=(o=s.next()).done);n=!0){var u=o.value;u.pointOnShape.type===N.pointType.sharp&&r.draw.dot(u.pointOnShape,.2,"green"),u.pointOnShape.type===N.pointType.dull&&r.draw.dot(u.pointOnShape,.4,"orange")}}catch(e){i=!0,a=e}finally{try{!n&&s.return&&s.return()}finally{if(i)throw a}}r.shape=e,r.drawStuff&&r.drawSomeStuff(e)}function v(e){var t=e.beziers,r=e.dullCornerHash,n=[],i=t.head;do{var a=(i.item,void 0);a=p([i.prev,i],r),Array.prototype.push.apply(n,a),a=m(i),Array.prototype.push.apply(n,a),i=i.next}while(i!==t.head);var o=n[0],s=n[n.length-1];return w.compare(o,s)>0&&(n.push(o),n.splice(0,1)),n}function h(e,t){return function(t){var r=t.beziers,n=r.head,i=0;do i+=e(n),n=n.next;while(n!==r.head);return i}}function f(e){var t=[];t.push(e.item),t.push(e.next.item);var r=[t[0].tangent(1),t[1].tangent(0)],n=I.dot(r[0],r[1]),i=I.cross(r[0],r[1]),a=Math.acos(n);return i>=0?a:-a}var d=function(){function e(e,t){var r=[],n=!0,i=!1,a=void 0;try{for(var o,s=e[Symbol.iterator]();!(n=(o=s.next()).done)&&(r.push(o.value),!t||r.length!==t);n=!0);}catch(e){i=!0,a=e}finally{try{!n&&s.return&&s.return()}finally{if(i)throw a}}return r}return function(t,r){if(Array.isArray(t))return t;if(Symbol.iterator in Object(t))return e(t,r);throw new TypeError("Invalid attempt to destructure non-iterable instance")}}(),p=e("../functions/get-contact-circles-at-bezier-bezier-interface.js"),m=e("../functions/get-bezier-osculating-circles.js"),g=(e("../../utils.js"),e("../../geometry/geometry.js")),y=e("../../ll-rb-tree//ll-rb-tree.js"),b=e("../../linked-loop/linked-loop.js"),x=(e("../../geometry/classes/bezier.js"),e("../../mat/classes/contact-point.js")),w=e("../../geometry/classes/point-on-shape.js"),j=(e("../../svg/svg.js"),e("../../mat/classes/mat-circle.js")),I=e("../../vector/vector.js"),N=e("../../mat-constants.js"),S=function(e,t){function r(e){return new x(e,(void 0))}this.beziers=e,this.dullCornerHash={};var s=v(this),u=n(this,s),c=u.map(r);this.contactPoints=i(c),o(this.contactPoints,45),this.for2Prongs=a(this.contactPoints,t),t&&l(this,c,t)};S.getNeighbouringPoints=function(e,t){var r=e.contactPoints.cptree,n=y.findBounds(r,{item:new x(t)});return n[0]&&n[1]?[n[0].data,n[1].data]:[y.max(r.root),y.min(r.root)]},S.getTotalCurvature=h(function(e){return+e.item.getTotalCurvature()+f(e)}),S.getTotalAbsoluteCurvature=h(function(e){return e.item.getTotalAbsoluteCurvature()+Math.abs(f(e))}),S.forAllBeziers=function(e,t){var r=e.beziers.head;do{var n=r.item;t(n),r=r.next}while(r!==e.beziers.head)},t.exports=S},{"../../geometry/classes/bezier.js":4,"../../geometry/classes/point-on-shape.js":6,"../../geometry/geometry.js":13,"../../linked-loop/linked-loop.js":14,"../../ll-rb-tree//ll-rb-tree.js":16,"../../mat-constants.js":17,"../../mat/classes/contact-point.js":19,"../../mat/classes/mat-circle.js":20,"../../svg/svg.js":41,"../../utils.js":42,"../../vector/vector.js":43,"../functions/get-bezier-osculating-circles.js":9,"../functions/get-contact-circles-at-bezier-bezier-interface.js":12}],8:[function(e,t,r){"use strict";function n(e){var t,r=i(e.bezierPoints,4),n=i(r[0],2),a=n[0],o=n[1],s=i(r[1],2),u=s[0],c=s[1],l=i(r[2],2),v=l[0],h=l[1],f=i(r[3],2),d=f[0],p=f[1],m=[],g=u-a,y=c-o,b=v-a,x=h-o,w=d-a,j=p-o,I=g,N=b-g,S=w-b,_=y,P=x-y,C=j-x,T=w-3*b+3*g,z=j-3*x+3*y,M=T*T,O=z*z,B=M/O+1,A=Math.sqrt(B),D=1/A;t=0===D?1:T/(z*A);var k=g*D-y*t,R=g*t+y*D,q=b*D-x*t,E=b*t+x*D,V=w*D-j*t,L=w*t+j*D;I=k,N=q-k,S=V-q,_=R,P=E-R,C=L-E;var F=3*(_-2*P+C),H=q-2*k;if(0===H);else{var Y,K,G,U,Q,Z,X,W,$,J,ee,te,re;!function(){H<0&&(k=-k,q=-q,V=-V,I=-I,N=-N,S=-S,H=-H),Y=6*H,K=3*F*I/(Y*Y),G=3*F*_/(Y*Y),U=3*(P-_)/Y,Q=K*K-2*U*K+G,Z=2*(U-K);var e=function(e){return(e-K)*(Y/F)},t=function(t){return[e(t[0]),e(t[1])]},r=function(e){var t=e[0],r=e[1];return!(t<0&&r<0||t>1&&r>1)&&(t<0&&(t=0),t>1&&(t=1),r<0&&(r=0),r>1&&(r=1),[t,r])};Q>0?(X=Math.sqrt(Q),W=-X,$=X,m=[[Number.NEGATIVE_INFINITY,W],[W,$],[$,Number.POSITIVE_INFINITY]].map(t).map(r)):Q<0&&(J=2*Z*Z-8*Q-3,J<0?m=[[0,Math.sqrt(-3*Q)]].map(t).map(r):(ee=Math.sqrt(5*J),te=(-5*Z-ee)/10,re=(-5*Z+ee)/10,m=[[Number.NEGATIVE_INFINITY,te],[te,Math.min(0,re)],[Math.max(0,re),Math.sqrt(-3*Q)]].map(t).map(r)))}()}return m}var i=function(){function e(e,t){var r=[],n=!0,i=!1,a=void 0;try{for(var o,s=e[Symbol.iterator]();!(n=(o=s.next()).done)&&(r.push(o.value),!t||r.length!==t);n=!0);}catch(e){i=!0,a=e}finally{try{!n&&s.return&&s.return()}finally{if(i)throw a}}return r}return function(t,r){if(Array.isArray(t))return t;if(Symbol.iterator in Object(t))return e(t,r);throw new TypeError("Invalid attempt to destructure non-iterable instance")}}();e("../classes/bezier.js");t.exports=n},{"../classes/bezier.js":4}],9:[function(e,t,r){"use strict";function n(e){for(var t=[],r=e.item,n=s(r),o=n.length,u=0;u<o;u++){var c=n[u];if(c){var v=i(r,c);if(v){var h=a(r,v,c);if(h){var f=h.p,d=h.circle,p=h.type,m=new l(f,e,v,p,0,d);t.push(m)}}}}return t.sort(l.compare),t}function i(e,t){var r=o(t,2),n=r[0],i=r[1],a=e.dκ(n),s=e.dκ(i);if(!(a*s>=0)){var u=v.brent(e.dκ,n,i);return u}}function a(e,t,r){var n=o(r,2),i=n[0],a=n[1],s=-e.κ(t);if(s>0){var l=-e.κ(i),v=-e.κ(a);if(s>l&&s>v);else if(s<=l&&s<=v)return}var h=void 0,f=void 0;s<0?(h=u.maxOsculatingCircleRadius,f=u.pointType.reverseOsculating):(h=Math.min(1/s,u.maxOsculatingCircleRadius),f=u.pointType.osculating);var d=e.normal(t),p=e.evaluate(t),m=[p[0]+d[0]*h,p[1]+d[1]*h],g=new c(m,h);return{p:p,circle:g,type:f}}var o=function(){function e(e,t){var r=[],n=!0,i=!1,a=void 0;try{for(var o,s=e[Symbol.iterator]();!(n=(o=s.next()).done)&&(r.push(o.value),!t||r.length!==t);n=!0);}catch(e){i=!0,a=e}finally{try{!n&&s.return&&s.return()}finally{if(i)throw a}}return r}return function(t,r){if(Array.isArray(t))return t;if(Symbol.iterator in Object(t))return e(t,r);throw new TypeError("Invalid attempt to destructure non-iterable instance")}}(),s=(e("../classes/bezier.js"),e("./calc-bezier-curvature-extrema.js")),u=e("../../mat-constants.js"),c=e("../../geometry/classes/circle.js"),l=e("../../geometry/classes/point-on-shape.js"),v=e("../../polynomial/polynomial.js");t.exports=n},{"../../geometry/classes/circle.js":5,"../../geometry/classes/point-on-shape.js":6,"../../mat-constants.js":17,"../../polynomial/polynomial.js":39,"../classes/bezier.js":4,"./calc-bezier-curvature-extrema.js":8}],10:[function(e,t,r){"use strict";function n(e,t,r,n,a,o,s){var c=.001,l=i(e,t),f=Number.POSITIVE_INFINITY,d=void 0,p=0,m=!0,g=!1,y=void 0;try{for(var b,x=l[Symbol.iterator]();!(m=(b=x.next()).done);m=!0){var w=b.value;p++;var j=s&&1===p,I=(w.bezierNode.item,u(w,t,r,c,n,a,o,j)),N=I.d,S=I.p;N<f&&(d=new v(S.p,w.bezierNode,S.t,h.pointType.standard,0,(void 0)),f=N)}}catch(e){g=!0,y=e}finally{try{!m&&x.return&&x.return()}finally{if(g)throw y}}return d}function i(e,t){var r=5,n=e.length>r;if(n){var i=a(e,t);e=o(e,t,i),e=s(e,t,i)}return e}function a(e,t){var r=Number.POSITIVE_INFINITY,n=!0,i=!1,a=void 0;try{for(var o,s=e[Symbol.iterator]();!(n=(o=s.next()).done);n=!0){var u=o.value,c=u.bezierNode.item,v=c.evaluate(u.tRange[0]),h=c.evaluate(u.tRange[1]),f=l.squaredDistanceBetween(t,v),d=l.squaredDistanceBetween(t,h),p=Math.min(f,d);p<r&&(r=p)}}catch(e){i=!0,a=e}finally{try{!n&&s.return&&s.return()}finally{if(i)throw a}}return r+.01}function o(e,t,r){var n=[],i=!0,a=!1,o=void 0;try{for(var s,u=e[Symbol.iterator]();!(i=(s=u.next()).done);i=!0){var l=s.value,v=l.bezierNode.item,h=v.getBoundingBox(),f=c.getClosestSquareDistanceToRect(h,t);f<=r&&n.push(l)}}catch(e){a=!0,o=e}finally{try{!i&&u.return&&u.return()}finally{if(a)throw o}}return n}function s(e,t,r){var n=[],i=!0,a=!1,o=void 0;try{for(var s,u=e[Symbol.iterator]();!(i=(s=u.next()).done);i=!0){var l=s.value,v=l.bezierNode.item,h=(v.getBoundingBoxTight(),c.closestSquaredDistanceToRotatedRect(v,t));h<=r&&n.push(l)}}catch(e){a=!0,o=e}finally{try{!i&&u.return&&u.return()}finally{if(a)throw o}}return n}var u=e("./get-closest-point-on-bezier-piece.js"),c=e("../geometry.js"),l=e("../../vector/vector.js"),v=e("../classes/Point-on-shape.js"),h=e("../../mat-constants.js");t.exports=n},{"../../mat-constants.js":17,"../../vector/vector.js":43,"../classes/Point-on-shape.js":2,"../geometry.js":13,"./get-closest-point-on-bezier-piece.js":11}],11:[function(e,t,r){"use strict";function n(e,t,r,n,o,s,u,c){u&&u.cpCalcs++;var l=e.bezierNode,v=([e.tRange],i.closestPointBetween_PointAndBezier(l,t,e.tRange,o,s,u,c));if(!v)return{d:Number.POSITIVE_INFINITY,p:void 0};var h=a.distanceBetween(v.p,t);return{d:h,p:v}}var i=e("../geometry.js"),a=e("../../vector/vector.js");t.exports=n},{"../../vector/vector.js":43,"../geometry.js":13}],12:[function(e,t,r){"use strict";function n(e,t){var r=[1,0],n=[0,1].map(function(t){return e[t].item}),c=[0,1].map(function(e){return n[e].tangent(r[e])}),l=+s.cross(c[0],c[1]),v=-s.dot(c[0],c[1]);if(0===l||v===-1)return[];var h=n[0].bezierPoints[3];if(l<-u){var f=new o(h,e[0],1,i.pointType.sharp,0,new a(h,0),1+v);return[f]}if(l>0){var d=o.makeSimpleKey(h);t[d]={bezier:n[0]}}if(l<=u)return[];for(var p=[],m=[-1,v],g=0;g<2;g++){var y=-n[g].κ(r[g]),b=Math.min(1/y,i.maxOsculatingCircleRadius);b<0&&(b=i.maxOsculatingCircleRadius);var x=n[g].normal(r[g]),w=[h[0]+x[0]*b,h[1]+x[1]*b],j=new o(h,e[g],r[g],i.pointType.dull,m[g],new a(w,b),1+v);p.push(j)}return p}var i=e("../../mat-constants.js"),a=e("../../geometry/classes/circle.js"),o=e("../../geometry/classes/point-on-shape.js"),s=e("../../vector/vector.js"),u=0;t.exports=n},{"../../geometry/classes/circle.js":5,"../../geometry/classes/point-on-shape.js":6,"../../mat-constants.js":17,"../../vector/vector.js":43}],13:[function(e,t,r){"use strict";function n(e,t){this.bezierNode=e,this.tRange=t}function i(e,t){var r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:[0,1],n=e[0].bezierNode.item===t,i=e[1].bezierNode.item===t;if(!n&&!i)return[r];var a=n&&!i,o=n?e[0].t:0,s=i?e[1].t:1,u=r[0],c=r[1];if(s<=u)return u===c&&a?[]:[r];if(o<=u&&s>=c)return[];if(u<=o&&c>=s){var l=[];return u!==o&&l.push([u,o]),s!==c&&l.push([s,c]),l}return o<=u&&s<=c?[[s,c]]:u<=o&&c<=s?[[u,o]]:void 0}function a(e,t){var r=t.radius,n=t.center[0],i=t.center[1],a=h.translatePoints(e.getBoundingBoxTight(),[-n,-i]),o=h.fromTo(a[0],a[1]),s=h.length(o),u=o[1]/s,c=o[0]/s,l=h.rotate(a[0],u,-c),v=h.rotate(a[2],u,-c),f=l[0]>-r&&l[0]<r||v[0]>-r&&v[0]<r,d=l[0]<-r&&v[0]>r||v[0]<-r&&l[0]>r,p=l[1]>-r&&l[1]<r||v[1]>-r&&v[1]<r,m=l[1]<-r&&v[1]>r||v[1]<-r&&l[1]>r;return!(f&&(p||m)||p&&(f||d)||d&&m)}var o=function(){function e(e,t){var r=[],n=!0,i=!1,a=void 0;try{for(var o,s=e[Symbol.iterator]();!(n=(o=s.next()).done)&&(r.push(o.value),!t||r.length!==t);n=!0);}catch(e){i=!0,a=e}finally{try{!n&&s.return&&s.return()}finally{if(i)throw a}}return r}return function(t,r){if(Array.isArray(t))return t;if(Symbol.iterator in Object(t))return e(t,r);throw new TypeError("Invalid attempt to destructure non-iterable instance")}}(),s=e("../utils.js"),u=e("../polynomial/polynomial.js"),c=e("./classes/circle.js"),l=e("./classes/arc.js"),v=e("./classes/point-on-shape.js"),h=(e("./classes/bezier.js"),e("../polynomial/functions/all-roots-vas.js"),e("../vector/vector.js")),f={};f.doesCircleEngulfCircle=function(e,t){if(e.radius<=t.radius)return!1;var r=h.squaredDistanceBetween(e.center,t.center),n=e.radius-t.radius,i=n*n;return i>r},f.doesLineIntersectCircle=function(e,t,r){var n=t[0],i=t[1],a=r[0],o=r[1],s=e.radius,u=e.center[0],c=e.center[1],l=a-n,v=o-i,h=n-u,f=i-c,d=l*l+v*v,p=2*(h*l+f*v),m=h*h+f*f-s*s,g=p*p-4*d*m;if(g<0)return!1;g=Math.sqrt(g);var y=(-p-g)/(2*d),b=(-p+g)/(2*d);return y>=0&&y<=1||b>=0&&b<=1},f.getBoundaryPieceBeziers=function(e,t){function r(e,t,r){for(var i=t.bezierNode;i!==r.bezierNode;)i=i.next,i!==r.bezierNode?e.push(new n(i,[0,1])):e.push(new n(i,[0,r.t]))}var i=!0,a=t[0],o=t[1],s=[],u=a.item.pointOnShape,c=new n(u.bezierNode,[u.t,u.t]),l=0;do{if(i){i=!1;var v=a.item.pointOnShape,h=a.next.item.pointOnShape;h.bezierNode===v.bezierNode?(c.tRange[1]=h.t,s.push(c)):(c.tRange[1]=1,s.push(c),r(s,v,h)),a=a.next}else{i=!0,a=a.prevOnCircle;var f=a.item.pointOnShape;c=new n(f.bezierNode,[f.t,f.t])}l++}while(a!==o);return s.push(c),s},f.getLineShapeIntersectionPoints=function(e,t,r){for(var n=[],i=f.getBoundaryPieceBeziers(t,r,!1),a=0;a<i.length;a++){bezierPiece=i[a];for(var o=bezierPiece.bezierNode.item,s=f.getLineBezierIntersectionPoints(e,o,bezierPiece.tRange),u=0;u<s.length;u++)n.push(s[u].p)}return n},f.closestSquaredDistanceToRotatedRect=function(e,t){var r=e.getBoundingBoxTight(),n=[0,1,2,3].map(function(e){return h.squaredDistanceBetweenPointAndLineSegment(t,[r[e],r[(e+1)%4]])});return s.bestBy(n)},f.getClosestSquareDistanceToRect=function(e,t){var r=e[0][0],n=e[0][1],i=e[1][0],a=e[1][1],o=t[0],s=t[1];if(o<r){if(s<n)return h.squaredDistanceBetween(e[0],t);if(s>a)return h.squaredDistanceBetween([r,a],t);var u=r-o;return u*u}if(o>i){if(s<n)return h.squaredDistanceBetween([i,n],t);if(s>a)return h.squaredDistanceBetween(e[1],t);var c=o-i;return c*c}if(s<n){var l=n-s;return l*l}if(s>a){var v=s-a;return v*v}return 0},f.getShapeRightMostInfo=function(e,t){for(var r=Number.NEGATIVE_INFINITY,n=void 0,i=0;i<e.length;i++){var a=e[i],o=a.getBoundingBox()[1][0];o>r&&(r=o,n=a)}return{maxX:r,maxBezier:n}},f.isShapePositivelyOrientated=function(e,t){var r=f.getShapeRightMostInfo(e,t),n=(r.maxX,r.maxBezier),i=n.tangent(n.tAtMaxX);return i[1]>0};var d=void 0,p=void 0,m=void 0,g=void 0,y=void 0,b=void 0;f.closestPointBetween_PointAndBezier=function(e,t,r,n,i,a,s){var c=e.item,l=n?n.item:void 0;if(d===c&&p===t&&m===i&&r[0]===y[0]&&r[1]===y[1]&&b===l)return g;d=c,p=t,m=i,y=r,b=l;var v=o(c.bezierPoints,4),f=o(v[0],2),x=f[0],w=f[1],j=o(v[1],2),I=j[0],N=j[1],S=o(v[2],2),_=S[0],P=S[1],C=o(v[3],2),T=C[0],z=C[1],M=o(t,2),O=M[0],B=M[1],A=x-O,D=I-O,k=_-O,R=T-O,q=w-B,E=N-B,V=P-B,L=z-B,F=A*A,H=6*A*D,Y=6*A*k,K=2*A*R,G=9*D*D,U=18*D*k,Q=6*D*R,Z=9*k*k,X=6*k*R,W=R*R,$=q*q,J=6*q*E,ee=6*q*V,te=2*q*L,re=9*E*E,ne=18*E*V,ie=6*E*L,ae=9*V*V,oe=6*V*L,se=L*L,ue=6*(W-X+Q-K+Z-U+Y+G-H+F+(se-oe+ie-te+ae-ne+ee+re-J+$)),ce=5*(X-2*Q+3*K-2*Z+3*U-4*Y-4*G+5*H-6*F+(oe-2*ie+3*te-2*ae+3*ne-4*ee-4*re+5*J-6*$)),le=4*(Q-3*K+Z-3*U+6*Y+6*G-10*H+15*F+(ie-3*te+ae-3*ne+6*ee+6*re-10*J+15*$)),ve=3*(K+U-4*Y-4*G+10*H-20*F+(te+ne-4*ee-4*re+10*J-20*$)),he=2*(Y+G-5*H+15*F+(ee+re-5*J+15*$)),fe=H-6*F+(J-6*$),de=[ue,ce,le,ve,he,fe];
if(c===l){var pe=u.deflate(de,i);de=pe}var me=u.allRoots01(de),ge=me.filter(function(e){return e>=r[0]&&e<=r[1]}),ye=!0,be=!0;(1===i&&e===n.next||c===l&&0===i)&&(ye=!1),(0===i&&e===n.prev||c===l&&1===i)&&(be=!1),0===r[0]?ye&&ge.push(r[0]):1===r[0]?be&&ge.push(r[0]):ge.push(r[0]),0===r[1]?ye&&ge.push(r[1]):1===r[1]?be&&ge.push(r[1]):ge.push(r[1]);var xe=ge.map(function(e){return{p:c.evaluate(e),t:e}}),we=h.getClosestTo(t,xe,function(e,t){return h.squaredDistanceBetween(e,t.p)});return g=we,we},f.degAngleFromSinCos=function(e,t){var r=function(e){return e*(180/Math.PI)};return 0===t?e>0?90:270:t>0?r(Math.atan(e/t)):180+r(Math.atan(e/t))},f.closestPointOnArc=function(e,t){if(null!==t.circle){var r=t.circle.center[0],n=t.circle.center[1],i=new l(new c([0,0],t.circle.radius),h.translate(t.startpoint,[-r,-n]),h.translate(t.endpoint,[-r,-n]),t.sin_angle1,t.cos_angle1,t.sin_angle2,t.cos_angle2),a=h.translate(e,[-r,-n]),o=h.length(a),s=-a[1]/o,u=a[0]/o;if(f.isAngleBetween(s,u,i.sin_angle1,i.cos_angle1,i.sin_angle2,i.cos_angle2)){var v=i.circle.radius,d={p:h.translate([v*u,v*-s],[r,n]),position:0};return d}var p=t.startpoint,m=t.endpoint,g=h.distanceBetween(p,e),y=h.distanceBetween(m,e);return g<y?{p:p,position:1}:{p:m,position:2}}var p=t.startpoint,m=t.endpoint,g=h.distanceBetween(p,e),y=h.distanceBetween(m,e),b=Math.sqrt(h.distanceBetweenPointAndLineSegment(e,[p,m]));if(g<=y&&g<=b)return{p:p,position:1};if(y<=g&&y<=b)return{p:m,position:2};var x=h.fromTo(p,m),w=[e[0]+x[1],e[1]+-x[0]],d={p:f.lineLineIntersection([e,w],[p,m]),position:0};return d},f.arcFrom3Points=function(e){var t,r=h.mean([e[0],e[1]]),n=h.mean([e[1],e[2]]),i=h.fromTo(e[0],e[1]),a=h.fromTo(e[1],e[2]),o=[i[1],-i[0]],s=[a[1],-a[0]],u=[r,h.translate(o,r)],v=[n,h.translate(s,n)],d=f.lineLineIntersection(u,v);if(null===d)return h.equal(e[0],e[2])?null:t=new l(null,e[0],e[2]);var p=h.fromTo(d,e[0]),m=h.fromTo(d,e[1]),g=h.fromTo(d,e[2]),y=h.length(p),b=-p[1]/y,x=p[0]/y,w=-g[1]/y,j=g[0]/y,I=-m[1]/y,N=m[0]/y;return t=f.isAngleBetween(I,N,b,x,w,j)?new l(new c(d,y),e[0],e[2],b,x,w,j):new l(new c(d,y),e[2],e[0],w,j,b,x)},f.quadrant=function(e,t){return e>=0?t>=0?1:2:t>=0?4:3},f.isAngle1LargerOrEqual=function(e,t,r,n){var i=f.quadrant(e,t),a=f.quadrant(r,n);return i>a||!(i<a)&&(1===i||4===i?e>=r:e<=r)},f.isAngleBetween=function(e,t,r,n,i,a){var o,s=f.isAngle1LargerOrEqual(r,n,i,a),u=f.isAngle1LargerOrEqual(e,t,i,a),c=f.isAngle1LargerOrEqual(e,t,r,n);return o=s?c||!u:c&&!u},f.lineLineIntersection=function(e,t){var r=e[0][0],n=e[0][1],i=e[1][0],a=e[1][1],o=t[0][0],s=t[0][1],u=t[1][0],c=t[1][1],l=i-r,v=a-n,h=u-o,f=c-s,d=h*v-f*l;if(0!==d){var p=((s-n)*l-(o-r)*v)/d;return[o+p*h,s+p*f]}},f.lineThroughPointAtRightAngleTo=function(e,t){var r=[-t[1],t[0]],n=e[0]+r[0],i=e[1]+r[1];return[e,[n,i]]},f.getLineBezierIntersectionPoints=function(e,t,r){var n=[-e[0][0],-e[0][1]],i=[e[1][0]+n[0],e[1][1]+n[1]],a=h.length(i),o=-i[1]/a,s=i[0]/a,c=h.translateThenRotatePoints(t.bezierPoints,n,o,s),l=(c[0][0],c[0][1]),v=(c[1][0],c[1][1]),f=(c[2][0],c[2][1]),d=(c[3][0],c[3][1]),p=[d-3*f+3*v-l,3*f-6*v+3*l,3*v-3*l,l],m=u.findCubicRoots01(p),g=m.map(function(e){return{p:t.evaluate(e),t:e}});return g},f.doesCircleIntersectShape=function(e,t,r){var n=.02;if(0===t.radius)return!1;var o=t.radius,s=t.center[0],c=t.center[1],l=[],f=e.beziers.head,d=v.split(r,n);do{var p=f.item;a(p,t)||l.push(p),f=f.next}while(f!==e.beziers.head);for(var m=0;m<l.length;m++){var g=l[m],y=h.translatePoints(g.bezierPoints,[-s,-c]),b=y[0][0],x=y[0][1],w=y[1][0],j=y[1][1],I=y[2][0],N=y[2][1],S=y[3][0],_=y[3][1],P=b*b,C=w*w,T=I*I,z=S*S,M=x*x,O=j*j,B=N*N,A=_*_,D=A-6*N*_+6*j*_-2*x*_+9*B-18*j*N+6*x*N+9*O-6*x*j+M+z-6*I*S+6*w*S-2*b*S+9*T-18*w*I+6*b*I+9*C-6*b*w+P,k=6*N*_-12*j*_+6*x*_-18*B+54*j*N-24*x*N-36*O+30*x*j-6*M+6*I*S-12*w*S+6*b*S-18*T+54*w*I-24*b*I-36*C+30*b*w-6*P,R=6*j*_-6*x*_+9*B-54*j*N+36*x*N+54*O-60*x*j+15*M+6*w*S-6*b*S+9*T-54*w*I+36*b*I+54*C-60*b*w+15*P,q=2*x*_+18*j*N-24*x*N-36*O+60*x*j-20*M+2*b*S+18*w*I-24*b*I-36*C+60*b*w-20*P,E=6*x*N+9*O-30*x*j+15*M+6*b*I+9*C-30*b*w+15*P,V=6*x*j-6*M+6*b*w-6*P,L=M+P-o*o,F=[D,k,R,q,E,V,L],H=i(d,g,void 0,!0,!1),Y=u.evaluate(F),K=!0,G=!1,U=void 0;try{for(var Q,Z=H[Symbol.iterator]();!(K=(Q=Z.next()).done);K=!0){var X=Q.value;if(Y(X[0])/Y(X[1])<0)return!0;var W=u.rootsWithin(F,X[0],X[1]);if(W>0)return!0}}catch(e){G=!0,U=e}finally{try{!K&&Z.return&&Z.return()}finally{if(G)throw U}}}return!1},t.exports=f},{"../polynomial/functions/all-roots-vas.js":37,"../polynomial/polynomial.js":39,"../utils.js":42,"../vector/vector.js":43,"./classes/arc.js":3,"./classes/bezier.js":4,"./classes/circle.js":5,"./classes/point-on-shape.js":6}],14:[function(e,t,r){"use strict";function n(e,t){t&&(this.cptree=new i(t)),this.addAllFromScratch(e||[])}var i=e("../ll-rb-tree/ll-rb-tree.js"),a=e("./list-node.js");n.insert=function(e,t,r,n){var o=new a(t,(void 0),(void 0)),s=void 0,u=void 0;return e.head?(s=r,u=s.next):(s=o,u=o,e.head=o),u.prev=o,s.next=o,o.prev=s,o.next=u,o.coupledNode=n,e.cptree&&i.insert(e.cptree,o),o},n.remove=function(e,t){var r=t.prev,n=t.next;t===e.head&&(e.head=n),r.next=n,n.prev=r,e.cptree&&i.remove(e.cptree,t)},n.getByIndx=function(e,t){return a.advanceNSteps(e.head,t)},n.prototype.addAllFromScratch=function(e){if(0!==e.length){for(var t,r=[],n=null,o=void 0,s=0;s<e.length;s++)o=new a(e[s],n,null,s),r.push(o),n&&(n.next=o),n=o,0===s&&(t=o),this.cptree&&i.insert(this.cptree,o);t.prev=o,o.next=t,this.head=t,this.nodeArr=r}},t.exports=n},{"../ll-rb-tree/ll-rb-tree.js":16,"./list-node.js":15}],15:[function(e,t,r){"use strict";function n(e,t,r){this.item=e,this.prev=t,this.next=r}n.advanceNSteps=function(e,t){for(var r=0;r<t;r++)e=e.next;return e},t.exports=n},{}],16:[function(e,t,r){"use strict";function n(e){this.data=e,this.red=!0}function i(e){this.comparator=e,this.root=null}function a(e,t){return function(t){for(;t[e];)t=t[e];return t}}function o(e,t){var r=t[!e];return t[!e]=r[e],r[e]=t,r.red=t.red,t.red=!0,r}function s(e){e.red=!e.red,e[v].red=!e[v].red,e[h].red=!e[h].red}function u(e){return s(e),n.isRed(e[h][v])&&(e[h]=o(h,e[h]),e=o(v,e),s(e)),e}function c(e){return s(e),n.isRed(e[v][v])&&(e=o(h,e),s(e)),e}function l(e){return n.isRed(e[h])&&(e=o(v,e)),n.isRed(e[v])&&n.isRed(e[v][v])&&(e=o(h,e)),n.isRed(e[v])&&n.isRed(e[h])&&s(e),e}var v=!1,h=!0;n.isRed=function(e){return e&&e.red},i.getMinNode=a(v),i.getMaxNode=a(h),i.min=function(e){return i.getMinNode(e).data},i.max=function(e){return i.getMaxNode(e).data},i.findBounds=function(e,t){var r=e.root;if(null===r)return null;for(var n=[];r;){var i=e.comparator(t,r.data);i>=0?n[0]=r:n[1]=r,r=r[i>=0]}return n},i.find=function(e,t){for(var r=e.root;r;){var n=e.comparator(t,r.data);if(0===n)return r;r=r[n>0]}return null},i.insert=function(e,t){function r(t,i){if(null==t)return new n(i);n.isRed(t[v])&&n.isRed(t[h])&&s(t);var a=e.comparator(i,t.data);return 0===a?t.data=i:a<0?t[v]=r(t[v],i):t[h]=r(t[h],i),n.isRed(t[h])&&!n.isRed(t[v])&&(t=o(v,t)),n.isRed(t[v])&&n.isRed(t[v][v])&&(t=o(h,t)),t}e.root=r(e.root,t),e.root.red=!1},i.remove=function(e,t){function r(t,s){return e.comparator(s,t.data)<0?(n.isRed(t[v])||n.isRed(t[v][v])||(t=u(t)),t[v]=r(t[v],s),l(t)):(n.isRed(t[v])&&(t=o(h,t)),t[h]||0!==e.comparator(s,t.data)?(n.isRed(t[h])||n.isRed(t[h][v])||(t=c(t)),0===e.comparator(s,t.data)?(t.data=i.min(t[h]),t[h]=a(t[h])):t[h]=r(t[h],s),l(t)):null)}function a(e){return e[v]?(n.isRed(e[v])||n.isRed(e[v][v])||(e=u(e)),e[v]=a(e[v]),l(e)):null}e.root=r(e.root,t),e.root&&(e.root.red=!1)},t.exports=i},{}],17:[function(e,t,r){"use strict";var n={maxOsculatingCircleRadius:200,pointType:{osculating:0,sharp:1,dull:2,reverseOsculating:3,standard:4}};t.exports=n},{}],18:[function(e,t,r){"use strict";var n=(e("./mat-constants.js"),e("./mat/functions/smoothen.js")),i=e("./mat/functions/find-mat.js"),a=e("./mat/functions/to-scale-axis.js"),o=e("./debug.js"),s=e("./geometry/classes/bezier.js"),u=(e("./mat/classes/mat-node.js"),e("./mat/classes/mat.js")),c=e("./mat/classes/mat-circle.js"),l=e("./mat/classes/contact-point.js"),v=e("./geometry/classes/point-on-shape.js"),h=e("./linked-loop/linked-loop.js"),f=e("./ll-rb-tree//ll-rb-tree.js"),d=e("./geometry/classes/shape.js"),p=e("./svg/svg.js"),m=e("./geometry/geometry.js"),g=e("./utils.js"),y=e("./vector/vector.js"),b=e("./polynomial/polynomial.js"),x=window.MatLib||{};x=Object.assign(x,{findMat:i,smoothen:n,toScaleAxis:a,Bezier:s,Mat:u,MatCircle:c,ContactPoint:l,PointOnShape:v,LinkedLoop:h,LlRbTree:f,Shape:d,Svg:p,MatDebug:o,Geometry:m,Util:g,Vector:y,Poly:b}),window.MatLib=x},{"./debug.js":1,"./geometry/classes/bezier.js":4,"./geometry/classes/point-on-shape.js":6,"./geometry/classes/shape.js":7,"./geometry/geometry.js":13,"./linked-loop/linked-loop.js":14,"./ll-rb-tree//ll-rb-tree.js":16,"./mat-constants.js":17,"./mat/classes/contact-point.js":19,"./mat/classes/mat-circle.js":20,"./mat/classes/mat-node.js":21,"./mat/classes/mat.js":22,"./mat/functions/find-mat.js":29,"./mat/functions/smoothen.js":32,"./mat/functions/to-scale-axis.js":33,"./polynomial/polynomial.js":39,"./svg/svg.js":41,"./utils.js":42,"./vector/vector.js":43}],19:[function(e,t,r){"use strict";function n(e,t){this.pointOnShape=e,this.matCircle=t,this.key=i.toHumanString(e),this.simpleKey=e.simpleKey,this[0]=e[0],this[1]=e[1]}var i=e("../../geometry/classes/point-on-shape.js"),a=e("../../vector/vector.js");n.compare=function(e,t){return i.compare(e.pointOnShape,t.pointOnShape)},n.equal=function(e,t){return a.equal(e,t)},t.exports=n},{"../../geometry/classes/point-on-shape.js":6,"../../vector/vector.js":43}],20:[function(e,t,r){"use strict";var n=(e("../../geometry/classes/circle.js"),function(e,t){this.circle=e,this.cpNodes=t,this.visited=0});n.copy=function(e){return new n(e.circle,e.cpNodes)},n.create=function(e,t){for(var r=new n(e,(void 0)),i=0;i<t.length;i++)t[i].item.matCircle=r;return r.cpNodes=t,r},t.exports=n},{"../../geometry/classes/circle.js":5}],21:[function(e,t,r){"use strict";function n(e,t){this.matCircle=e,this.branches=t}e("./mat-circle.js");n.copy=function(e){function t(e,r,i){var a=[],o=new n(e.matCircle,a),s=!0,u=!1,c=void 0;try{for(var l,v=e.branches[Symbol.iterator]();!(s=(l=v.next()).done);s=!0){var h=l.value;h!==r?a.push(t(h,e,o)):a.push(i)}}catch(e){u=!0,c=e}finally{try{!s&&v.return&&v.return()}finally{if(u)throw c}}return o}return t(e,void 0)},t.exports=n},{"./mat-circle.js":20}],22:[function(e,t,r){"use strict";function n(e){this.startNode=e}var i=e("../../mat/functions/traverse.js");n=Object.assign(n,{traverse:i}),t.exports=n},{"../../mat/functions/traverse.js":34}],23:[function(e,t,r){"use strict";function n(e,t,r,n,c){var l=(r.item,new a(n,(void 0))),v=u.getNeighbouringPoints(e,n),h=a.compare(v[0].item,l),f=a.compare(l,v[1].item);if(c&&(h>0||f>0)&&console.log("2-PRONG Order is wrong 2: "+h+", "+f),h>=0||f>=0)return void o.remove(e.contactPoints,r);var d=o.insert(e.contactPoints,l,v[0]);s.create(t,[r,d]);return r.prevOnCircle=d,d.prevOnCircle=r,r.nextOnCircle=d,d.nextOnCircle=r,c&&(i(r,c),i(d,c)),d}function i(e,t){var r=e.item.pointOnShape.simpleKey,n=t.generated.cpHash,i=t.generated.cpArr;n[r]||(n[r]={cp:e,arrIndx:i.length},i.push(e));var a=n[r];a.visitedPointsArr=a.visitedPointsArr||[]}var a=(e("../../geometry/classes/circle.js"),e("../../mat/classes/contact-point.js")),o=e("../../linked-loop/linked-loop.js"),s=e("../../mat/classes/mat-circle.js"),u=e("../../geometry/classes/shape.js");t.exports=n},{"../../geometry/classes/circle.js":5,"../../geometry/classes/shape.js":7,"../../linked-loop/linked-loop.js":14,"../../mat/classes/contact-point.js":19,"../../mat/classes/mat-circle.js":20}],24:[function(e,t,r){"use strict";function n(e,t,r){for(var n=t.circle,s=t.ps,u=t.delta3s,c=[],l=0;l<3;l++)c.push(new a(s[l],(void 0)));if(r){a.compare(c[0],c[1]),a.compare(c[1],c[2])}if(r)for(var v=[],h=0;h<3;h++)v.push(a.compare(u[h][0].item,c[h])),v[h]>0&&(console.log("3-PRONG Order is wrong : i: "+h+" - cmp: "+v[h]),console.log(t));for(var f=[],d=0;d<3;d++)f.push(o.insert(e.contactPoints,c[d],u[d][0]));for(var p=i.create(n,f),m=[2,0,1],g=[1,2,0],y=0;y<3;y++)f[y].prevOnCircle=f[m[y]],f[y].nextOnCircle=f[g[y]];return p}var i=e("../../mat/classes/mat-circle.js"),a=e("../../mat/classes/contact-point.js"),o=e("../../linked-loop/linked-loop.js");t.exports=n},{"../../linked-loop/linked-loop.js":14,"../../mat/classes/contact-point.js":19,"../../mat/classes/mat-circle.js":20}],25:[function(e,t,r){"use strict";function n(e,t,r,s,u,c){var l=void 0;do l=a(t),l.length>2&&o(e,l,c);while(l.length>2);if(1===t.item.matCircle.cpNodes.length&&s.nextOnCircle===t.next){var v=i(t,r?[r]:[],c);return v}if(1===l.length){var h=i(t,r?[r]:[],c);return h}if(2===l.length){for(var f=r?[r]:[],d=i(t,f,c),p=t,m=0;p.nextOnCircle!==t&&p.next!==p.nextOnCircle;){m++;var g=void 0;if(1===m)g=p.next,t.item.matCircle.visited++;else if(2===m&&(g=p,1!==p.item.matCircle.visited))break;var y=n(e,g,d,p,!1,c);f.push(y),p=p.nextOnCircle}return d}}function i(e,t,r){var n=new l(e.item.matCircle,t);return r&&s(e,n,r),n}function a(e){var t=void 0,r=e;t=[];do{t.push(r);var n=r.next;r=n.prevOnCircle}while(r!==e);return t}function o(e,t,r){for(var n=[],i=0;i<t.length;i++){var a=t[i];n.push([a,a.next])}for(var o=!1,s=0;s<n.length;s++){var l=s+1;l===n.length&&(l=0);var f=n[s][1].item,d=n[l][0].item;if(v.equal(f,d)){o=!0;break}}for(var p=u(e,n,r),m=0;m<3;m++)h.setPointOrder(e,p.circle,p.ps[m],r);c(e,p,r)}function s(e,t,r){var n=e.item.matCircle.circle,i=h.makeSimpleKey(n.center),a=r.generated.nodeHash;a[i]=a[i]||{},a[i].matNode=t;var o=e.item.pointOnShape.simpleKey,s=r.generated.cpHash,u=r.generated.cpArr;s[o]||(s[o]={cp:e,arrIndx:u.length},u.push(e));var c=s[o];c.visitedPointsArr=c.visitedPointsArr||[]}var u=e("./find-3-prong.js"),c=e("./add-3-prong.js"),l=e("../../mat/classes/mat-node.js"),v=e("../../mat/classes/contact-point.js"),h=e("../../geometry/classes/point-on-shape.js");t.exports=n},{"../../geometry/classes/point-on-shape.js":6,"../../mat/classes/contact-point.js":19,"../../mat/classes/mat-node.js":21,"./add-3-prong.js":24,"./find-3-prong.js":28}],26:[function(e,t,r){"use strict";function n(e){return new a(i.copy(e.startNode))}var i=e("../../mat/classes/mat-node.js"),a=e("../classes/mat.js");t.exports=n},{"../../mat/classes/mat-node.js":21,"../classes/mat.js":22}],27:[function(e,t,r){"use strict";function n(e,t,r){var n=t.item.pointOnShape,u=[t,t],l=!1,y=Number.POSITIVE_INFINITY,b=t.item.pointOnShape,x=b.bezierNode,w=b.t,j=t.item.matCircle.circle.center,I=f.getBoundaryPieceBeziers(e,u),N=void 0,S=void 0,_=void 0,P=0;do{P++;var C=m.squaredDistanceBetween(j,n);I=a(I,j,C,r),S=p(I,j,n,x,w,r);var T=m.squaredDistanceBetween(n,S);if(T<=c){l=!0;break}var z=o(j,n,S);_=m.squaredDistanceBetween(j,z);var M=m.squaredDistanceBetween(n,z);M<y&&(y=M),j=z,r&&(N=N||[],N.push({x:j,y:n,z:S,t:w}))}while(_>v&&P<s);P===s&&(l=!0);var O=new h(j,m.distanceBetween(j,S));return r&&i(r,l,t,O,n,S,u,N),l?void d.remove(e.contactPoints,t):(g.setPointOrder(e,O,S,r),{circle:O,z:S})}function i(e,t,r,n,i,a,o,s){t?(e.draw.dot(r.item,1,"black"),e.draw.dot(r.item,.1,"yellow")):(e.draw.dot(n.center,.5,"yellow"),e.drawStuff&&(e.draw.circle(n,"red thin2 nofill"),e.draw.dot(r.item,.55,"red"),e.draw.dot(a,.7,"red"))),e.twoProngs.push({twoProng:r,"δ":o,y:i,x:n.center,xs:s,failed:t})}function a(e,t,r,n){var i=5;if(e.length<=i)return e;var a=[],o=!0,s=!1,u=void 0;try{for(var c,l=e[Symbol.iterator]();!(o=(c=l.next()).done);o=!0){var v=c.value,h=v.bezierNode.item,d=h.getBoundingBox(),p=f.getClosestSquareDistanceToRect(d,t);p<=r&&a.push(v)}}catch(e){s=!0,u=e}finally{try{!o&&l.return&&l.return()}finally{if(s)throw u}}return a}function o(e,t,r){var n=Math.abs((e[1]-t[1])/(e[0]-t[0]))>1,i=void 0,a=void 0,o=void 0,s=void 0,u=void 0,c=void 0;n?(i=e[1],a=e[0],o=t[1],s=t[0],u=r[1],c=r[0]):(i=e[0],a=e[1],o=t[0],s=t[1],u=r[0],c=r[1]);var l=(a-s)/(i-o),v=s-l*o,h=o*o+s*s-u*u-c*c+2*v*(c-s),f=o-u+l*(s-c),d=h/(2*f),p=l*d+v;return n?[p,d]:[d,p]}var s=50,u=.01,c=u*u,l=u/10,v=l*l,h=e("../../geometry/classes/circle.js"),f=e("../../geometry/geometry.js"),d=(e("../../geometry/classes/shape.js"),e("../../linked-loop/linked-loop.js")),p=e("../../geometry/functions/get-closest-boundary-point-to-point.js"),m=e("../../vector/vector.js"),g=e("../../geometry/classes/Point-on-shape.js");t.exports=n},{"../../geometry/classes/Point-on-shape.js":2,"../../geometry/classes/circle.js":5,"../../geometry/classes/shape.js":7,"../../geometry/functions/get-closest-boundary-point-to-point.js":10,"../../geometry/geometry.js":13,"../../linked-loop/linked-loop.js":14,"../../vector/vector.js":43}],28:[function(e,t,r){"use strict";function n(e,t,r){var n=t.map(function(t){return f.getBoundaryPieceBeziers(e,t)}),a=void 0,o=void 0,u=void 0;r&&(u={cs:[]});for(var c=void 0,l=Number.POSITIVE_INFINITY,v=1;v<t.length-1;v++){var p=i(e,t,v,n,u,r),m=p.radiusDelta,g=p.ps,y=p.x;m<l&&(l=m,c=v,a=g,o=y)}var b=d.distanceBetween(o,a[0])+d.distanceBetween(o,a[1])+d.distanceBetween(o,a[2]),x=new h(o,b/3),w=[t[0],t[c],t[t.length-1]],j={delta3s:w,circle:x,ps:a};return r&&s(j,t,c,u,a,r),j}function i(e,t,r,n,i,s){for(var u=1e-7,h=[t[0],t[r],t[t.length-1]],f=[n[0],n[r],n[t.length-1]],m=void 0,y=void 0,b=0,x=o(e,h,f,s),w=Number.POSITIVE_INFINITY;w>u&&b<10;){b++,m=c(x,f,s),y=l(m,s);var j=g(x,y),I=a(f,x,j,s);x=I.newX;var N=d.length(j);m=I.newPs,w=Math.abs(N-I.newV)}for(var S=d.length(d.fromTo(m[0],y)),_=[],P=0;P<n.length;P++){var C=p(n[P],y,void 0,void 0,void 0,s);_.push(d.length(d.fromTo(C,y)))}var T=v.bestBy(_),z=S-T;return s&&i.cs.push({ps:m,x:x,ccr:S,indxi:r}),{radiusDelta:z,ps:m,x:x}}function a(e,t,r,n){var i=d.length(r),a=1,o=void 0,s=void 0,u=void 0,v=void 0,h=0;do{var f=d.scale(r,a);s=d.translate(t,f),u=c(s,e,n);var p=l(u,n),m=d.fromTo(s,p);v=d.length(m),o=v<i,a/=2,h++}while(!o&&h<3);return{newX:s,newV:v,newPs:u}}function o(e,t,r,n){var i=d.mean([t[0][0].item,t[2][1].item]),a=p(r[1],i,void 0,void 0,void 0,n),o=[t[0][0].item,a,t[2][1].item],s=void 0;if(s=1===t[0][0].item.pointOnShape.type?d.mean([o[0],o[1]]):d.circumCenter(o),!Number.isFinite(s[0]),!Number.isFinite(s[0])){var c=u(o);return d.mean([o[c[0]],o[c[1]]])}return s}function s(e,t,r,n,i,a){if(a.nProngs.push(e),n.deltas=t,n.deltasSimple=t.map(function(e){return[m.toHumanString(e[0].item.pointOnShape),m.toHumanString(e[1].item.pointOnShape)]}),n.iindx=r,a.drawStuff)for(var o=0;o<i.length;o++){var s=i[o];a.draw.dot(s,.1*(o+1),"blue")}a.drawStuff&&(a.draw.dot(e.circle.center,.3,"blue"),a.draw.circle(e.circle,"blue thin1 nofill"))}function u(e){return e[0][0]===e[1][0]&&e[0][1]===e[1][1]?[0,2]:e[1][0]===e[2][0]&&e[1][1]===e[2][1]?[0,2]:e[2][0]===e[0][0]&&e[2][1]===e[0][1]?[1,2]:[]}function c(e,t,r){return t.map(function(t){var n=p(t,e,void 0,void 0,void 0,r);return n})}function l(e,t){var r=5e-4,n=5e-4,i=d.distanceBetween(e[0],e[1]),a=d.distanceBetween(e[1],e[2]),o=d.distanceBetween(e[2],e[0]),s=void 0;if(i<r?s=[0,1,2]:a<r?s=[1,2,0]:o<r&&(s=[2,0,1]),s){for(var u=[m.splitBack(e[s[0]],n),m.split(e[s[0]],n),m.splitForward(e[s[0]],n)],c=u.map(function(t){return d.circumCenter([t[0],t[1],e[s[2]]])}),l=0,v=Number.POSITIVE_INFINITY,h=0;h<3;h++){var f=d.distanceBetween(c[h],e[s[2]]);f<v&&(v=f,l=h)}return c[l]}return d.circumCenter(e)}var v=e("../..//utils.js"),h=e("../../geometry/classes/circle.js"),f=e("../../geometry/geometry.js"),d=e("../../vector/vector.js"),p=e("../../geometry/functions/get-closest-boundary-point-to-point.js"),m=e("../../geometry/classes/point-on-shape.js"),g=d.fromTo;t.exports=n},{"../..//utils.js":42,"../../geometry/classes/circle.js":5,"../../geometry/classes/point-on-shape.js":6,"../../geometry/functions/get-closest-boundary-point-to-point.js":10,"../../geometry/geometry.js":13,"../../vector/vector.js":43}],29:[function(e,t,r){"use strict";function n(e,t){var r=void 0;r=performance.now(),i(e,t);var n=performance.now();t&&(t.add2ProngsDuration=n-r),console.log("    2-prongs took "+(n-r).toFixed(0)+" milliseconds.");var o=void 0;o=performance.now();var s=e.contactPoints,u=s.head;do{if(2===u.item.matCircle.cpNodes.length)break;u=u.next}while(u!==s.head);var v=u.prevOnCircle,h=c(e,v.prevOnCircle,void 0,void 0,!1,t),f=c(e,v,void 0,void 0,!1,t);f.branches.push(f.branches[0]),f.branches[0]=h.branches[0],h.branches[0].branches[0]=f;var d=new l(f),p=performance.now();t&&(t.add2ProngsDuration=p-o),console.log("    3-prongs took "+(p-o).toFixed(0)+" milliseconds.");var m=a(d);return m}function i(e,t){for(var r=e.for2Prongs,n=r.length,i=o(n),a=0;a<n;a++){var c=r[i[a]],l=u(e,c,t);if(l){var h=l.circle,f=l.z;s(e,h,c,f,t)}else v++}console.log("2-prong fails: "+v)}function a(e){function t(e,r){if(3===e.branches.length&&e.branches[2].matCircle===e.matCircle){var n=e.branches[2],i=n.branches[1];e.branches[2]=i,i.branches[0]=e}var a=!0,o=!1,s=void 0;try{for(var u,c=e.branches[Symbol.iterator]();!(a=(u=c.next()).done);a=!0){var l=u.value;l!==r&&t(l,e)}}catch(e){o=!0,s=e}finally{try{!a&&c.return&&c.return()}finally{if(o)throw s}}}return t(e.startNode,void 0),e}function o(e){for(var t=[],r=0;r<e;r++)t.push(r);return t}var s=e("./add-2-prong.js"),u=e("./find-2-prong.js"),c=e("./build-mat.js"),l=e("../classes/mat.js"),v=0;t.exports=n},{"../classes/mat.js":22,"./add-2-prong.js":23,"./build-mat.js":25,"./find-2-prong.js":27}],30:[function(e,t,r){"use strict";function n(e){var t=[];return i(e,function(e){t.push(e)}),t}var i=e("./traverse.js");t.exports=n},{"./traverse.js":34}],31:[function(e,t,r){"use strict";function n(e){var t={};return a(e,function(e){var r=i.makeSimpleKey(e.matCircle.circle.center);t[r]=e}),t}var i=e("../../geometry/classes/point-on-shape.js"),a=e("./traverse.js");t.exports=n},{"../../geometry/classes/point-on-shape.js":6,"./traverse.js":34}],32:[function(e,t,r){"use strict";function n(e,t){function r(e){for(var t=i(e,2),r=t[0],n=t[1],a=0;a<r.length;a++)for(var o=r[a],s=0;s<n.length;s++){var u=n[s];if(o.next===u)return[o,u]}}s.traverse(e,function(e,n){function s(e,t,r){var n=e.item,i=r?e.nextOnCircle.item:e.prevOnCircle.item,a=void 0;if(n!==i){var s=o.fromTo(n,i);a=o.rotateBy90Degrees(s)}else if(n.pointOnShape.type===u.pointType.sharp){var c=void 0,l=void 0;0===n.pointOnShape.t?(c=n.pointOnShape.bezierNode,l=n.pointOnShape.bezierNode.prev):1===n.pointOnShape.t&&(c=n.pointOnShape.bezierNode.next,l=n.pointOnShape.bezierNode);var v=c.item.tangent(0),h=o.reverse(l.item.tangent(1)),f=o.dot(v,h),d=Math.sqrt((1+f)/2),p=Math.sqrt((1-f)/2);a=o.rotate(h,p,d)}else a=o.fromTo(n,t);var m=o.translate(t,o.toLength(a,1)),g=[t,m];return g}if(n){var h=n.matCircle,f=h.circle.center,d=h.cpNodes,p=e.matCircle,m=p.circle.center,g=p.cpNodes,y=r([d,g]),b=i(y,2),x=b[0],w=b[1],j=s(x,f,!0),I=s(w,m,!1),N=a.lineLineIntersection(j,I),S=void 0;if(N){var _=o.fromTo(f,N),P=o.fromTo(m,N),C=o.fromTo(f,m),T=o.dot(_,C),z=o.dot(P,C);S=T<0||z>0}if(N)if(S){var M=o.mean([f,m]),O=o.fromTo(f,m),B=o.rotateBy90Degrees(O),A=o.translate(M,B),D=[M,A],k=a.lineLineIntersection(j,D),R=a.lineLineIntersection(I,D);t&&t.draw.bezier({bezierPoints:[f,k,R,m]},v)}else t&&t.draw.quadBezier([f,N,m],l);else t&&t.draw.line([f,m],c)}})}var i=function(){function e(e,t){var r=[],n=!0,i=!1,a=void 0;try{for(var o,s=e[Symbol.iterator]();!(n=(o=s.next()).done)&&(r.push(o.value),!t||r.length!==t);n=!0);}catch(e){i=!0,a=e}finally{try{!n&&s.return&&s.return()}finally{if(i)throw a}}return r}return function(t,r){if(Array.isArray(t))return t;if(Symbol.iterator in Object(t))return e(t,r);throw new TypeError("Invalid attempt to destructure non-iterable instance")}}(),a=e("../../geometry/geometry.js"),o=e("../../vector/vector.js"),s=e("../classes/mat.js"),u=e("../../mat-constants.js"),c="nofill thin20 blue",l="nofill thin20 blue",v="nofill thin20 blue";t.exports=n},{"../../geometry/geometry.js":13,"../../mat-constants.js":17,"../../vector/vector.js":43,"../classes/mat.js":22}],33:[function(e,t,r){"use strict";function n(e,t,r){var n=d(e),i=p(n),u=-Number.POSITIVE_INFINITY,l=void 0;for(var h in i){var f=i[h],m=f.matCircle.circle.radius;m>u&&(l=f,u=m)}var g=(performance.now(),a(t,i));performance.now();r&&r.shouldDrawSATTree&&r.drawSATTree(g);var b=new y(l),x={};s(g,o,{s:t,tree:g,cullHash:x});var w=[];return c(x,w,b.startNode),v(w),b}function i(e,t,r,n,a,o,s){var u=6,c=a.matCircle.circle,l=h(e,r,n,c),v=l.groups,f=l.newLimits;if(1===v.length&&s!==u){var d=v[0];t[d]||(t[d]={});var p=t[d],m=r?0:1;return void i(e,p,m,f,a,o,s+1)}t[5]||(t[5]=new Map);var g=t[5];g.set(o,a)}function a(e,t){var r=0,n=[[0,b],[0,x]],a={};for(var o in t){var s=t[o];i(e,a,r,n,s,o,0)}return a}function o(e,t,r){var n=r.s,i=r.tree,a=r.cullHash;if(0!==e.matCircle.circle.radius&&!a[t]){var o=u(n,i,e);for(var s in o)a[s]||(a[s]=e)}}function s(e,t,r){function n(e){if(e){if(e.size)return void e.forEach(function(e,n){t(e,n,r)});e[5]&&n(e[5]),e[0]&&n(e[0]),e[2]&&n(e[2]),e[4]&&n(e[4]),e[1]&&n(e[1]),e[3]&&n(e[3])}}n(e)}function u(e,t,r){function n(t){var r=t[5];r&&r.forEach(function(t,n){var i=f.scale(t.matCircle.circle,e);m.doesCircleEngulfCircle(a,i)&&(o[n]=t,r.delete(n))})}function i(t,r,a,o){if(null!==a){var s=h(e,r,a,u),c=s.groups,l=s.newLimits;if(1!==c.length){n(t);for(var v=0;v<=4;v++){var f=t[v];f&&i(f,0,null,o+1)}}else{n(t);var d=c[0],p=r?0:1;if(1===d||3===d){var m=t[d];m&&i(m,p,l,o+1)}else{var g=[];g.push(t[d]),d>0&&g.push(t[d-1]),d<4&&g.push(t[d+1]);var y=!0,b=!1,x=void 0;try{for(var w,j=g[Symbol.iterator]();!(y=(w=j.next()).done);y=!0){var I=w.value;I&&i(I,p,l,o+1)}}catch(e){b=!0,x=e}finally{try{!y&&j.return&&j.return()}finally{if(b)throw x}}}}}else{n(t);for(var N=0;N<=4;N++){var S=t[N];S&&i(S,0,null,o+1)}}}var a=f.scale(r.matCircle.circle,e),o={},s=[[0,b],[0,x]],u=r.matCircle.circle;return i(t,0,s,0),o}function c(e,t,r,n){var i=g.makeSimpleKey(r.matCircle.circle.center),a=!e[i],o=!0,s=!1,u=void 0;try{for(var l,v=r.branches[Symbol.iterator]();!(o=(l=v.next()).done);o=!0){var h=l.value;h!==n&&c(e,t,h,r)&&(a=!0)}}catch(e){s=!0,u=e}finally{try{!o&&v.return&&v.return()}finally{if(s)throw u}}return!!a||(t.push({satNode:r,priorNode:n}),!1)}function l(e){var t=e.satNode,r=e.priorNode,n=r.branches.indexOf(t);n>=0&&r.branches.splice(n,1)}function v(e){var t=!0,r=!1,n=void 0;try{for(var i,a=e[Symbol.iterator]();!(t=(i=a.next()).done);t=!0){var o=i.value;l(o)}}catch(e){r=!0,n=e}finally{try{!t&&a.return&&a.return()}finally{if(r)throw n}}}function h(e,t,r,n){var i=r[t],a=i[0],o=i[1],s=(o-a)/4,u=s+s,c=n.radius,l=n.center[t]-a,v=l-c*e,h=l+c*e,f=[,],d=[],p=Math.floor(v/s),m=Math.floor(h/s)+1,g=m-p,y=void 0;if(1===g){y=2*Math.floor(p/2)+1,d.push(y);var b=a+s*(y-1);f=[b,b+u]}else if(2===g){y=p+1,d.push(y);var x=a+s*(y-1);f=[x,x+u]}var w=[,];if(1===d.length){var j=t?0:1;w[j]=r[j],w[t]=f}return{groups:d,newLimits:w}}var f=e("../../geometry/classes/circle.js"),d=e("./copy-mat.js"),p=e("./get-nodes-as-hash.js"),m=e("../../geometry/geometry.js"),g=e("../../geometry/classes/point-on-shape.js"),y=e("../classes/mat.js"),b=620,x=560;t.exports=n},{"../../geometry/classes/circle.js":5,"../../geometry/classes/point-on-shape.js":6,"../../geometry/geometry.js":13,"../classes/mat.js":22,"./copy-mat.js":26,"./get-nodes-as-hash.js":31}],34:[function(e,t,r){"use strict";function n(e,t){function r(e,n){t(e,n);for(var i=0;i<e.branches.length;i++){var a=e.branches[i];a!==n&&r(a,e,i)}}r(e.startNode,void 0,void 0)}e("../../geometry/classes/point-on-shape.js");t.exports=n},{"../../geometry/classes/point-on-shape.js":6}],35:[function(e,t,r){"use strict";function n(e,t){this.numer=e,this.denom=t}var i=e("../polynomial/polynomial.js");n.changeVariables=function(e,t,r){return new n(i.changeVariables(e.numer,t,r),i.changeVariables(e.denom,t,r))},n.invert=function(e){return new n([e.numer[1],e.numer[0]],[e.denom[1],e.denom[0]])},n.evaluateAt0=function(e){return e.numer[1]/e.denom[1]},n.evaluateAtInf=function(e){return e.numer[0]/e.denom[0]},n.evaluate=function(e,t){return i.evaluate(e.numer)(t)/i.evaluate(e.denom)(t)},t.exports=n},{"../polynomial/polynomial.js":39}],36:[function(e,t,r){"use strict";function n(e,t,r){for(var n=r||16,o=a[n],s=o.weights,u=o.abscissas,c=i(t,2),l=c[0],v=c[1],h=0,f=(v-l)/2,d=(v+l)/2,p=0;p<=n-1;p++)h+=s[p]*e(f*u[p]+d);return f*h}var i=function(){function e(e,t){var r=[],n=!0,i=!1,a=void 0;try{for(var o,s=e[Symbol.iterator]();!(n=(o=s.next()).done)&&(r.push(o.value),!t||r.length!==t);n=!0);}catch(e){i=!0,a=e}finally{try{!n&&s.return&&s.return()}finally{if(i)throw a}}return r}return function(t,r){if(Array.isArray(t))return t;if(Symbol.iterator in Object(t))return e(t,r);throw new TypeError("Invalid attempt to destructure non-iterable instance")}}(),a={2:{weights:[1,1],abscissas:[-.5773502691896257,.5773502691896257]},4:{weights:[.6521451548625461,.6521451548625461,.3478548451374538,.3478548451374538],abscissas:[-.3399810435848563,.3399810435848563,-.8611363115940526,.8611363115940526]},8:{weights:[.362683783378362,.362683783378362,.3137066458778873,.3137066458778873,.2223810344533745,.2223810344533745,.1012285362903763,.1012285362903763],abscissas:[-.1834346424956498,.1834346424956498,-.525532409916329,.525532409916329,-.7966664774136267,.7966664774136267,-.9602898564975363,.9602898564975363]},16:{abscissas:[-.9894009349916499,-.9445750230732326,-.8656312023878318,-.755404408355003,-.6178762444026438,-.45801677765722737,-.2816035507792589,-.09501250983763744,.09501250983763744,.2816035507792589,.45801677765722737,.6178762444026438,.755404408355003,.8656312023878318,.9445750230732326,.9894009349916499],weights:[.027152459411754096,.062253523938647894,.09515851168249279,.12462897125553388,.14959598881657674,.16915651939500254,.18260341504492358,.1894506104550685,.1894506104550685,.18260341504492358,.16915651939500254,.14959598881657674,.12462897125553388,.09515851168249279,.062253523938647894,.027152459411754096]}};t.exports=n},{}],37:[function(e,t,r){"use strict";function n(e,t,r){var n=void 0;n=t[0]<=0&&t[1]>=0?i.zeroRoots(e):{p:e,numZeros:0};for(var a=n.p,o=n.numZeros,s=i.vasRootIntervals(a,t).filter(function(e){var n=e[1]<t[0]||e[0]>t[1];return n&&r&&r.rootsSkipped++,!n}).map(function(e){return r&&r.rootsNotSkipped++,i.brent(i.evaluate(a),e[0],e[1],1e-7)}),u=0;u<o;u++)s.push(0);return s}var i=e("../../polynomial/polynomial.js"),a=e("../../mobius/mobius.js");i.vasRootIntervals=function(e,t){var r=i.vasRootIntervalsHelper(e,new a([1,0],[0,1]),t),n=[].concat(r);return n},i.vasRootIntervalsHelper=function(e,t,r){var n=i.signChanges(e);if(0===n)return[];if(1===n){var o=a.evaluateAt0(t),s=a.evaluateAtInf(t),u=Math.min(o,s),c=Math.max(o,s);return c===Number.POSITIVE_INFINITY&&(c=a.evaluate(t,i.positiveRootUpperBound(e))),[[u,c]]}var l=i.positiveRootLowerBound(e);l>1&&(e=i.changeVariables(e,1,l),t=a.changeVariables(t,1,l));var v=i.changeVariables(i.invert(e),1,1),h=a.changeVariables(a.invert(t),1,1),f=a.evaluate(t,1),d=i.changeVariables(e,1,1),p=a.changeVariables(t,1,1),m=i.vasRootIntervalsHelper(v,h,r),g=i.vasRootIntervalsHelper(d,p,r);return 0===i.evaluate(e)(1)&&m.push([f,f]),[].concat(m,g)},t.exports=n},{"../../mobius/mobius.js":35,"../../polynomial/polynomial.js":39}],38:[function(e,t,r){"use strict";function n(e){function t(e){return e<0?-Math.pow(-e,1/3):Math.pow(e,1/3)}function r(e){return e>=0&&e<=1}var n,i,a,o,s,u=e[0],c=e[1]/u,l=e[2]/u,v=e[3]/u,h=(3*l-c*c)/3,f=h/3,d=(2*c*c*c-9*c*l+27*v)/27,p=d/2,m=p*p+f*f*f;if(m<0){var g=-h/3,y=g*g*g,b=Math.sqrt(y),x=-d/(2*b),w=x<-1?-1:x>1?1:x,j=Math.acos(w),I=t(b),N=2*I;return a=N*Math.cos(j/3)-c/3,o=N*Math.cos((j+2*Math.PI)/3)-c/3,s=N*Math.cos((j+4*Math.PI)/3)-c/3,[a,o,s].filter(r)}if(0===m)return n=p<0?t(-p):-t(p),a=2*n-c/3,o=-n-c/3,[a,o].filter(r);var S=Math.sqrt(m);return n=t(S-p),i=t(S+p),a=n-i-c/3,[a].filter(r)}t.exports=n},{}],39:[function(e,t,r){"use strict";function n(e,t,r){return t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function i(e){for(var t=[],r=e.length-1,n=r;0!==n;n--){var i=e[r-n]*n;n===r&&0===i||t.push(i)}return t}function a(e,t){if(0===e)return[];for(var r=t.length-1,n=[],i=r;i>=0;i--)n.push(e*t[r-i]);return n}function o(e){return T.multiplyByConst(-1,e)}function s(e,t){for(var r=e.length-1,n=t.length-1,i=Math.max(r,n),a=[],o=0;o<i+1;o++)a.push(0);
for(var o=i;o>=0;o--){var s=e[i-o],u=t[i-o];a[i-o]=(s?s:0)-(u?u:0)}return a}function u(e,t){for(var r=e.length-1,n=t.length-1,i=r+n,a=[],o=0;o<i+1;o++)a.push(0);for(var o=r;o>=0;o--)for(var s=n;s>=0;s--)a[i-(o+s)]+=e[r-o]*t[n-s];return a}function c(e){return e.length-1}function l(e){return function(t){for(var r=e[0],n=1;n<e.length;n++)r=e[n]+r*t;return r}}function v(e){return e[e.length-1]}function h(e){for(var t=0,r=e.length-1,n=0,i=r;i>=0;i--){var a=Math.sign(e[r-i]);0!==a&&(0!==n&&n!==a&&t++,n=a)}return t}function f(e,t){for(var r=e.length-1,n=t.length-1,i=r-n,a=0;a<i-1;a++)t.unshift(0);n=r-1;var o=e[1]/e[0]-t[1]/t[0],s=e,u=T.multiplyByConst(e[0]/t[0],t),c=T.multiply(u,[1,o]),l=T.minus(c,s);return l.slice(2)}function d(e,t){for(var r=(e.length-1,[e[0]]),n=1;n<e.length-1;n++)r.push(e[n]+t*r[n-1]);return r}function p(e){var t=[];t.push(e),t.push(T.differentiate(e));for(var r=1;T.degree(t[r])>0;)t.push(T.remainder(t[r-1],t[r])),r++;return t}function m(e,t,r){var n=T.sturmChain(e),i=n.map(function(e){return T.evaluate(e)(t)}),a=n.map(function(e){return T.evaluate(e)(r)});return T.signChanges(i)-T.signChanges(a)}function g(e,t){for(var r=T.differentiate(e),n=t,i=1;i<=10;i++)n-=T.evaluate(e)(n)/T.evaluate(r)(n);return n}function y(e){var t=e.length-1;if(t<1)return 0;e[0]<0&&(e=T.negate(e));for(var r=[],n=0;n<t;n++)r.push(1);for(var i=0,a=0;a<=t;a++)if(!(e[a]>=0)){for(var o=Number.POSITIVE_INFINITY,s=!1,u=0;u<a;u++)if(!(e[u]<=0)){var c=Math.pow(-e[a]/(e[u]/Math.pow(2,r[u])),1/(a-u));r[u]++,o>c&&(o=c),s=!0}s&&i<o&&(i=o)}return i}function b(e){for(var t=e.length,r=[],n=t-1;n>=0;n--)r.push(e[n]);return r}function x(e,t,r){for(var n=e.length-1,i=new Array(n+1).fill(0),a=[],o=0;o<n+1;o++)a.push(new Array(n+1).fill(0));a[0][0]=1;for(var s=1;s<=n;s++){a[0][s]=r*a[0][s-1];for(var u=1;u<=s;u++)a[u][s]=r*a[u][s-1]+t*a[u-1][s-1]}for(var c=0;c<=n;c++){i[n-c]=0;for(var l=c;l<=n;l++){var v=a[c][l]*e[n-l];i[n-c]+=v}}return i}function w(e){return 1/T.positiveRootUpperBound(T.invert(e))}function j(e){for(var t=e.slice(),r=0;0===T.evaluateAt0(t);){var n=t.length;t.splice(n-1,1),r++}return{p:t,numZeros:r}}function I(e){var t=e.length-1;if(2===t)return T.findQuadraticRoots01(e);if(3===t)return T.findCubicRoots01(e).sort(function(e,t){return e-t});var r=T.differentiate(e),n=I(r);return 0!==n[0]&&n.unshift(0),1!==n[n.length-1]&&n.push(1),m(e,n)}function m(e,t){for(var r=t.length,n=[],i=T.evaluate(e),a=0;a<r-1;a++){var o=t[a],s=t[a+1],u=i(o),c=i(s);if(0===u||0===c)return 0===u&&n.push(o),0===c&&n.push(s),n;var l=u/c;if(l<0){var v=T.brent(i,o,s);n.push(v)}}return n}function N(e){var t,r,n=P(e,3),i=n[0],a=n[1],o=n[2],s=a*a-4*i*o;if(s<0)return[];if(0===s)return t=-a/(2*i),t>=0&&t<=1?[t]:[];s=Math.sqrt(s),a>=0?(t=(-a-s)/(2*i),r=2*o/(-a-s)):(t=2*o/(-a+s),r=(-a+s)/(2*i));var u=t>=0&&t<=1,c=r>=0&&r<=1;return u?c?t<r?[t,r]:[r,t]:[t]:c?[r]:[]}function S(e,t,r,n){if(z++,t===r)return t;var i=e(t),a=e(r);if(i*a>=0)throw"Root not bracketed";var o=void 0;Math.abs(i)<Math.abs(a)&&(o=t,t=r,r=o),o=t;for(var s=!0,u=0,c=void 0;;){u++;var l=e(o),v=void 0;if(i=e(t),a=e(r),i!==l&&a!==l){var h=i-l,f=i-a,d=a-l;v=((t*a*d-r*i*h)*l+o*i*f*a)/(f*h*d)}else v=r-a*((r-t)/(a-i));var p=(3*t+r)/4,m=Math.abs(r-o),g=Math.abs(v-r),y=Math.abs(o-x);!(v>p&&v<r||v<p&&v>r)||s&&(g>=m/2||m<n)||!s&&(g>=y/2||y<n)?(v=(t+r)/2,s=!0):s=!1;var b=e(v),x=o;if(o=r,i*b<0?r=v:t=v,Math.abs(i)<Math.abs(a)){var w=t;t=r,r=w}if(0===a)return r;if(0===b)return v;var j=Math.abs(t-r);if(j/t+j/r<M||0===j||c<=j)return r;c=j}}var _,P=function(){function e(e,t){var r=[],n=!0,i=!1,a=void 0;try{for(var o,s=e[Symbol.iterator]();!(n=(o=s.next()).done)&&(r.push(o.value),!t||r.length!==t);n=!0);}catch(e){i=!0,a=e}finally{try{!n&&s.return&&s.return()}finally{if(i)throw a}}return r}return function(t,r){if(Array.isArray(t))return t;if(Symbol.iterator in Object(t))return e(t,r);throw new TypeError("Invalid attempt to destructure non-iterable instance")}}(),C=e("./functions/find-cubic-roots.js"),T=(e("../utils.js"),_={findQuadraticRoots01:N,findCubicRoots01:C,brent:S,positiveRootLowerBound:w,positiveRootUpperBound:y,zeroRoots:j,rootsWithin:m,allRoots01:I,newton:g},n(_,"rootsWithin",m),n(_,"multiplyByConst",a),n(_,"negate",o),n(_,"minus",s),n(_,"multiply",u),n(_,"differentiate",i),n(_,"sturmChain",p),n(_,"degree",c),n(_,"evaluate",l),n(_,"evaluateAt0",v),n(_,"signChanges",h),n(_,"invert",b),n(_,"changeVariables",x),n(_,"deflate",d),n(_,"remainder",f),_),z=0,M=1e-15;t.exports=T},{"../utils.js":42,"./functions/find-cubic-roots.js":38}],40:[function(e,t,r){"use strict";function n(){SVGPathElement.prototype.getPathData&&SVGPathElement.prototype.setPathData||i()}function i(){var e={Z:"Z",M:"M",L:"L",C:"C",Q:"Q",A:"A",H:"H",V:"V",S:"S",T:"T",z:"Z",m:"m",l:"l",c:"c",q:"q",a:"a",h:"h",v:"v",s:"s",t:"t"},t=function(e){this._string=e,this._currentIndex=0,this._endIndex=this._string.length,this._prevCommand=null,this._skipOptionalSpaces()},r=window.navigator.userAgent.indexOf("MSIE ")!==-1;t.prototype={parseSegment:function(){var t=this._string[this._currentIndex],r=e[t]?e[t]:null;if(null===r){if(null===this._prevCommand)return null;if(r=("+"===t||"-"===t||"."===t||t>="0"&&t<="9")&&"Z"!==this._prevCommand?"M"===this._prevCommand?"L":"m"===this._prevCommand?"l":this._prevCommand:null,null===r)return null}else this._currentIndex++;this._prevCommand=r;var n=null,i=r.toUpperCase();return"H"===i||"V"===i?n=[this._parseNumber()]:"M"===i||"L"===i||"T"===i?n=[this._parseNumber(),this._parseNumber()]:"S"===i||"Q"===i?n=[this._parseNumber(),this._parseNumber(),this._parseNumber(),this._parseNumber()]:"C"===i?n=[this._parseNumber(),this._parseNumber(),this._parseNumber(),this._parseNumber(),this._parseNumber(),this._parseNumber()]:"A"===i?n=[this._parseNumber(),this._parseNumber(),this._parseNumber(),this._parseArcFlag(),this._parseArcFlag(),this._parseNumber(),this._parseNumber()]:"Z"===i&&(this._skipOptionalSpaces(),n=[]),null===n||n.indexOf(null)>=0?null:{type:r,values:n}},hasMoreData:function(){return this._currentIndex<this._endIndex},peekSegmentType:function(){var t=this._string[this._currentIndex];return e[t]?e[t]:null},initialCommandIsMoveTo:function(){if(!this.hasMoreData())return!0;var e=this.peekSegmentType();return"M"===e||"m"===e},_isCurrentSpace:function(){var e=this._string[this._currentIndex];return e<=" "&&(" "===e||"\n"===e||"\t"===e||"\r"===e||"\f"===e)},_skipOptionalSpaces:function(){for(;this._currentIndex<this._endIndex&&this._isCurrentSpace();)this._currentIndex+=1;return this._currentIndex<this._endIndex},_skipOptionalSpacesOrDelimiter:function(){return!(this._currentIndex<this._endIndex&&!this._isCurrentSpace()&&","!==this._string[this._currentIndex])&&(this._skipOptionalSpaces()&&this._currentIndex<this._endIndex&&","===this._string[this._currentIndex]&&(this._currentIndex+=1,this._skipOptionalSpaces()),this._currentIndex<this._endIndex)},_parseNumber:function(){var e=0,t=0,r=1,n=0,i=1,a=1,o=this._currentIndex;if(this._skipOptionalSpaces(),this._currentIndex<this._endIndex&&"+"===this._string[this._currentIndex]?this._currentIndex+=1:this._currentIndex<this._endIndex&&"-"===this._string[this._currentIndex]&&(this._currentIndex+=1,i=-1),this._currentIndex===this._endIndex||(this._string[this._currentIndex]<"0"||this._string[this._currentIndex]>"9")&&"."!==this._string[this._currentIndex])return null;for(var s=this._currentIndex;this._currentIndex<this._endIndex&&this._string[this._currentIndex]>="0"&&this._string[this._currentIndex]<="9";)this._currentIndex+=1;if(this._currentIndex!==s)for(var u=this._currentIndex-1,c=1;u>=s;)t+=c*(this._string[u]-"0"),u-=1,c*=10;if(this._currentIndex<this._endIndex&&"."===this._string[this._currentIndex]){if(this._currentIndex+=1,this._currentIndex>=this._endIndex||this._string[this._currentIndex]<"0"||this._string[this._currentIndex]>"9")return null;for(;this._currentIndex<this._endIndex&&this._string[this._currentIndex]>="0"&&this._string[this._currentIndex]<="9";)n+=(this._string[this._currentIndex]-"0")*(r*=.1),this._currentIndex+=1}if(this._currentIndex!==o&&this._currentIndex+1<this._endIndex&&("e"===this._string[this._currentIndex]||"E"===this._string[this._currentIndex])&&"x"!==this._string[this._currentIndex+1]&&"m"!==this._string[this._currentIndex+1]){if(this._currentIndex+=1,"+"===this._string[this._currentIndex]?this._currentIndex+=1:"-"===this._string[this._currentIndex]&&(this._currentIndex+=1,a=-1),this._currentIndex>=this._endIndex||this._string[this._currentIndex]<"0"||this._string[this._currentIndex]>"9")return null;for(;this._currentIndex<this._endIndex&&this._string[this._currentIndex]>="0"&&this._string[this._currentIndex]<="9";)e*=10,e+=this._string[this._currentIndex]-"0",this._currentIndex+=1}var l=t+n;return l*=i,e&&(l*=Math.pow(10,a*e)),o===this._currentIndex?null:(this._skipOptionalSpacesOrDelimiter(),l)},_parseArcFlag:function(){if(this._currentIndex>=this._endIndex)return null;var e=null,t=this._string[this._currentIndex];if(this._currentIndex+=1,"0"===t)e=0;else{if("1"!==t)return null;e=1}return this._skipOptionalSpacesOrDelimiter(),e}};var n,i=function(e){if(!e||0===e.length)return[];var r=new t(e),n=[];if(r.initialCommandIsMoveTo())for(;r.hasMoreData();){var i=r.parseSegment();if(null===i)break;n.push(i)}return n},a=SVGPathElement.prototype.setAttribute,o=SVGPathElement.prototype.removeAttribute;n=window.Symbol?{cachedPathData:Symbol(),cachedNormalizedPathData:Symbol()}:{cachedPathData:"__cachedPathData",cachedNormalizedPathData:"__cachedNormalizedPathData"};var s=function e(t,r,n,i,a,o,s,u,c,l){var v,h,f,d,p=function(e){return Math.PI*e/180},m=function(e,t,r){var n=e*Math.cos(r)-t*Math.sin(r),i=e*Math.sin(r)+t*Math.cos(r);return{x:n,y:i}},g=p(s),y=[];if(l)v=l[0],h=l[1],f=l[2],d=l[3];else{var b=m(t,r,-g);t=b.x,r=b.y;var x=m(n,i,-g);n=x.x,i=x.y;var w=(t-n)/2,j=(r-i)/2,I=w*w/(a*a)+j*j/(o*o);I>1&&(I=Math.sqrt(I),a=I*a,o=I*o);var N;N=u===c?-1:1;var S=a*a,_=o*o,P=S*_-S*j*j-_*w*w,C=S*j*j+_*w*w,T=N*Math.sqrt(Math.abs(P/C));f=T*a*j/o+(t+n)/2,d=T*-o*w/a+(r+i)/2,v=Math.asin(((r-d)/o).toFixed(9)),h=Math.asin(((i-d)/o).toFixed(9)),t<f&&(v=Math.PI-v),n<f&&(h=Math.PI-h),v<0&&(v=2*Math.PI+v),h<0&&(h=2*Math.PI+h),c&&v>h&&(v-=2*Math.PI),!c&&h>v&&(h-=2*Math.PI)}var z=h-v;if(Math.abs(z)>120*Math.PI/180){var M=h,O=n,B=i;h=c&&h>v?v+120*Math.PI/180*1:v+120*Math.PI/180*-1,n=f+a*Math.cos(h),i=d+o*Math.sin(h),y=e(n,i,O,B,a,o,s,0,c,[h,M,f,d])}z=h-v;var A=Math.cos(v),D=Math.sin(v),k=Math.cos(h),R=Math.sin(h),q=Math.tan(z/4),E=4/3*a*q,V=4/3*o*q,L=[t,r],F=[t+E*D,r-V*A],H=[n+E*R,i-V*k],Y=[n,i];if(F[0]=2*L[0]-F[0],F[1]=2*L[1]-F[1],l)return[F,H,Y].concat(y);y=[F,H,Y].concat(y).join().split(",");var K=[],G=[];return y.forEach(function(e,t){t%2?G.push(m(y[t-1],y[t],g).y):G.push(m(y[t],y[t+1],g).x),6===G.length&&(K.push(G),G=[])}),K},u=function(e){return e.map(function(e){return{type:e.type,values:Array.prototype.slice.call(e.values)}})},c=function(e){var t=[],r=null,n=null,i=null,a=null;return e.forEach(function(e){var o=e.type;if("M"===o){var s=e.values[0],u=e.values[1];t.push({type:"M",values:[s,u]}),i=s,a=u,r=s,n=u}else if("m"===o){var s=r+e.values[0],u=n+e.values[1];t.push({type:"M",values:[s,u]}),i=s,a=u,r=s,n=u}else if("L"===o){var s=e.values[0],u=e.values[1];t.push({type:"L",values:[s,u]}),r=s,n=u}else if("l"===o){var s=r+e.values[0],u=n+e.values[1];t.push({type:"L",values:[s,u]}),r=s,n=u}else if("C"===o){var c=e.values[0],l=e.values[1],v=e.values[2],h=e.values[3],s=e.values[4],u=e.values[5];t.push({type:"C",values:[c,l,v,h,s,u]}),r=s,n=u}else if("c"===o){var c=r+e.values[0],l=n+e.values[1],v=r+e.values[2],h=n+e.values[3],s=r+e.values[4],u=n+e.values[5];t.push({type:"C",values:[c,l,v,h,s,u]}),r=s,n=u}else if("Q"===o){var c=e.values[0],l=e.values[1],s=e.values[2],u=e.values[3];t.push({type:"Q",values:[c,l,s,u]}),r=s,n=u}else if("q"===o){var c=r+e.values[0],l=n+e.values[1],s=r+e.values[2],u=n+e.values[3];t.push({type:"Q",values:[c,l,s,u]}),r=s,n=u}else if("A"===o){var s=e.values[5],u=e.values[6];t.push({type:"A",values:[e.values[0],e.values[1],e.values[2],e.values[3],e.values[4],s,u]}),r=s,n=u}else if("a"===o){var s=r+e.values[5],u=n+e.values[6];t.push({type:"A",values:[e.values[0],e.values[1],e.values[2],e.values[3],e.values[4],s,u]}),r=s,n=u}else if("H"===o){var s=e.values[0];t.push({type:"H",values:[s]}),r=s}else if("h"===o){var s=r+e.values[0];t.push({type:"H",values:[s]}),r=s}else if("V"===o){var u=e.values[0];t.push({type:"V",values:[u]}),n=u}else if("v"===o){var u=n+e.values[0];t.push({type:"V",values:[u]}),n=u}else if("S"===o){var v=e.values[0],h=e.values[1],s=e.values[2],u=e.values[3];t.push({type:"S",values:[v,h,s,u]}),r=s,n=u}else if("s"===o){var v=r+e.values[0],h=n+e.values[1],s=r+e.values[2],u=n+e.values[3];t.push({type:"S",values:[v,h,s,u]}),r=s,n=u}else if("T"===o){var s=e.values[0],u=e.values[1];t.push({type:"T",values:[s,u]}),r=s,n=u}else if("t"===o){var s=r+e.values[0],u=n+e.values[1];t.push({type:"T",values:[s,u]}),r=s,n=u}else"Z"!==o&&"z"!==o||(t.push({type:"Z",values:[]}),r=i,n=a)}),t},l=function(e){var t=[],r=null,n=null,i=null,a=null,o=null,u=null,c=null;return e.forEach(function(e){if("M"===e.type){var l=e.values[0],v=e.values[1];t.push({type:"M",values:[l,v]}),u=l,c=v,a=l,o=v}else if("C"===e.type){var h=e.values[0],f=e.values[1],d=e.values[2],p=e.values[3],l=e.values[4],v=e.values[5];t.push({type:"C",values:[h,f,d,p,l,v]}),n=d,i=p,a=l,o=v}else if("L"===e.type){var l=e.values[0],v=e.values[1];t.push({type:"L",values:[l,v]}),a=l,o=v}else if("H"===e.type){var l=e.values[0];t.push({type:"L",values:[l,o]}),a=l}else if("V"===e.type){var v=e.values[0];t.push({type:"L",values:[a,v]}),o=v}else if("S"===e.type){var m,g,d=e.values[0],p=e.values[1],l=e.values[2],v=e.values[3];"C"===r||"S"===r?(m=a+(a-n),g=o+(o-i)):(m=a,g=o),t.push({type:"C",values:[m,g,d,p,l,v]}),n=d,i=p,a=l,o=v}else if("T"===e.type){var h,f,l=e.values[0],v=e.values[1];"Q"===r||"T"===r?(h=a+(a-n),f=o+(o-i)):(h=a,f=o);var m=a+2*(h-a)/3,g=o+2*(f-o)/3,y=l+2*(h-l)/3,b=v+2*(f-v)/3;t.push({type:"C",values:[m,g,y,b,l,v]}),n=h,i=f,a=l,o=v}else if("Q"===e.type){var h=e.values[0],f=e.values[1],l=e.values[2],v=e.values[3],m=a+2*(h-a)/3,g=o+2*(f-o)/3,y=l+2*(h-l)/3,b=v+2*(f-v)/3;t.push({type:"C",values:[m,g,y,b,l,v]}),n=h,i=f,a=l,o=v}else if("A"===e.type){var x=e.values[0],w=e.values[1],j=e.values[2],I=e.values[3],N=e.values[4],l=e.values[5],v=e.values[6];if(0===x||0===w)t.push({type:"C",values:[a,o,l,v,l,v]}),a=l,o=v;else if(a!==l||o!==v){var S=s(a,o,l,v,x,w,j,I,N);S.forEach(function(e){t.push({type:"C",values:e}),a=l,o=v})}}else"Z"===e.type&&(t.push(e),a=u,o=c);r=e.type}),t};SVGPathElement.prototype.setAttribute=function(e,t){"d"===e&&(this[n.cachedPathData]=null,this[n.cachedNormalizedPathData]=null),a.call(this,e,t)},SVGPathElement.prototype.removeAttribute=function(e,t){"d"===e&&(this[n.cachedPathData]=null,this[n.cachedNormalizedPathData]=null),o.call(this,e)},SVGPathElement.prototype.getPathData=function(e){if(e&&e.normalize){if(this[n.cachedNormalizedPathData])return u(this[n.cachedNormalizedPathData]);var t;this[n.cachedPathData]?t=u(this[n.cachedPathData]):(t=i(this.getAttribute("d")||""),this[n.cachedPathData]=u(t));var r=l(c(t));return this[n.cachedNormalizedPathData]=u(r),r}if(this[n.cachedPathData])return u(this[n.cachedPathData]);var t=i(this.getAttribute("d")||"");return this[n.cachedPathData]=u(t),t},SVGPathElement.prototype.setPathData=function(e){if(0===e.length)r?this.setAttribute("d",""):this.removeAttribute("d");else{for(var t="",n=0,i=e.length;n<i;n+=1){var a=e[n];n>0&&(t+=" "),t+=a.type,a.values&&(t+=" "+a.values.join(" "))}this.setAttribute("d",t)}}}t.exports=n},{}],41:[function(e,t,r){"use strict";function n(e){for(var t=[],r=0,n=e.length-1;n>=0;n--)t.push(i(e[n],r)),r++;return t}function i(e,t){for(var r=[],n=3;n>=0;n--)r.push(e.bezierPoints[n]);var i=new a(r,t);return i}var a=e("../geometry/classes/bezier.js"),o=e("./path-data-polyfill/path-data-polyfill.js"),s=e("../linked-loop/linked-loop.js"),u=e("../geometry/geometry.js"),c={};c.getBeziersFromSvgElem=function(e){o();for(var t=e.getPathData(),r=[],i=t[0].values[0],c=t[0].values[1],l=0,v=0;v<t.length;v++){var h=t[v];if("C"===h.type||"c"===h.type){var f=[[i,c],[h.values[0],h.values[1]],[h.values[2],h.values[3]],[h.values[4],h.values[5]]],d=new a(f,l);r.push(d),i=h.values[4],c=h.values[5],l++}}var p=void 0;return p=u.isShapePositivelyOrientated(r)?n(r):r,new s(p)},t.exports=c},{"../geometry/classes/bezier.js":4,"../geometry/geometry.js":13,"../linked-loop/linked-loop.js":14,"./path-data-polyfill/path-data-polyfill.js":40}],42:[function(e,t,r){"use strict";var n={};n.bestBy=function(e,t){var r=void 0,n=t||function(e){return e},i=Number.POSITIVE_INFINITY,a=!0,o=!1,s=void 0;try{for(var u,c=e[Symbol.iterator]();!(a=(u=c.next()).done);a=!0){var l=u.value,v=n(l);v<i&&(r=l,i=v)}}catch(e){o=!0,s=e}finally{try{!a&&c.return&&c.return()}finally{if(o)throw s}}return r},n.min=function(e){return Math.min.apply(null,e)},n.max=function(e){return Math.max.apply(null,e)},t.exports=n},{}],43:[function(e,t,r){"use strict";function n(e,t,r){return e[0]*(t[1]*r[2]-t[2]*r[1])-e[1]*(t[0]*r[2]-t[2]*r[0])+e[2]*(t[0]*r[1]-t[1]*r[0])}function i(e){return e[0]*e[0]+e[1]*e[1]}var a={};a.dot=function(e,t){return e[0]*t[0]+e[1]*t[1]},a.cross=function(e,t){return e[0]*t[1]-e[1]*t[0]},a.squaredDistanceBetween=function(e,t){var r=t[0]-e[0],n=t[1]-e[1];return r*r+n*n},a.scale=function(e,t){return[e[0]*t,e[1]*t]},a.reverse=function(e){return[e[0]*-1,e[1]*-1]},a.toUnitVector=function(e){var t=1/a.length(e);return[e[0]*t,e[1]*t]},a.toLength=function(e,t){var r=t/a.length(e);return[e[0]*r,e[1]*r]},a.fromTo=function(e,t){return[t[0]-e[0],t[1]-e[1]]},a.mean=function(e){var t=e[0],r=e[1];return[(t[0]+r[0])/2,(t[1]+r[1])/2]},a.distanceBetween=function(e,t){return Math.sqrt(a.squaredDistanceBetween(e,t))},a.length=function(e){return Math.sqrt(e[0]*e[0]+e[1]*e[1])},a.lengthSquared=function(e){return e[0]*e[0]+e[1]*e[1]},a.distanceBetweenPointAndLine=function(e,t){var r=e[0],n=e[1],i=t[0][0],a=t[0][1],o=t[1][0],s=t[1][1],u=s-a,c=o-i,l=u*r-c*n+o*a-s*i,v=Math.sqrt(u*u+c*c);return Math.abs(l/v)},a.squaredDistanceBetweenPointAndLineSegment=function(e,t){var r=t[0],n=t[1],i=a.squaredDistanceBetween(r,n);if(0==i)return a.squaredDistanceBetween(e,r);var o=((e[0]-r[0])*(n[0]-r[0])+(e[1]-r[1])*(n[1]-r[1]))/i;o=Math.max(0,Math.min(1,o));var s=a.squaredDistanceBetween(e,[r[0]+o*(n[0]-r[0]),r[1]+o*(n[1]-r[1])]);return s},a.circumCenter=function(e){var t=e[0],r=e[1],a=e[2],o=.5*n([i(t),t[1],1],[i(r),r[1],1],[i(a),a[1],1]),s=.5*n([t[0],i(t),1],[r[0],i(r),1],[a[0],i(a),1]),u=n([t[0],t[1],1],[r[0],r[1],1],[a[0],a[1],1]);n([t[0],t[1],i(t)],[r[0],r[1],i(r)],[a[0],a[1],i(a)]);return[o/u,s/u]},a.inCenter=function(e){var t=e[0],r=e[1],n=e[2],i=a.distanceBetween(r,n),o=a.distanceBetween(t,n),s=a.distanceBetween(t,r),u=i+o+s;return[(i*t[0]+o*r[0]+s*n[0])/u,(i*t[1]+o*r[1]+s*n[1])/u]},a.centroid=function(e){if(3===e.length){var t=e[0],r=e[1],n=e[2],i=t[0]+r[0]+n[0],a=t[1]+r[1]+n[1];return[i/3,a/3]}for(var o=0,s=0;s<e.length;s++){var u=e[s],c=s===e.length-1?e[0]:e[s+1];o+=u[0]*c[1]-c[0]*u[1]}o/=2;for(var l=[0,0],v=0;v<e.length;v++){var h=e[v],f=v===e.length-1?e[0]:e[v+1];l[0]=l[0]+(h[0]+f[0])*(h[0]*f[1]-f[0]*h[1]),l[1]=l[1]+(h[1]+f[1])*(h[0]*f[1]-f[0]*h[1])}return[l[0]/(6*o),l[1]/(6*o)]},a.translate=function(e,t){return[e[0]+t[0],e[1]+t[1]]},a.equal=function(e,t){return e[0]===t[0]&&e[1]===t[1]},a.rotate=function(e,t,r){return[e[0]*r-e[1]*t,e[0]*t+e[1]*r]},a.reverseRotate=function(e,t,r){return[+e[0]*r+e[1]*t,-e[0]*t+e[1]*r]},a.rotateBy90Degrees=function(e){return[-e[1],e[0]]},a.rotateByNeg90Degrees=function(e){return[e[1],-e[0]]},a.transform=function(e,t){return[t(e[0]),t(e[1])]},a.getClosestTo=function(e,t,r){for(var n=r||a.squaredDistanceBetween,i=void 0,o=Number.POSITIVE_INFINITY,s=0;s<t.length;s++){var u=t[s],c=n(e,u);c<o&&(i=u,o=c)}return i},a.translatePoints=function(e,t){for(var r=[],n=0;n<e.length;n++)r.push([e[n][0]+t[0],e[n][1]+t[1]]);return r},a.rotatePoints=function(e,t,r){return e.map(function(e){return a.rotate(e,t,r)})},a.translateThenRotatePoints=function(e,t,r,n){return e.map(function(e){return a.rotate(a.translate(e,t),r,n)})},a.rotateThenTranslatePoints=function(e,t,r,n){return e.map(function(e){return a.translate(a.rotate(e,r,n),t)})},t.exports=a},{}]},{},[18]);
//# sourceMappingURL=mat-lib.min.js.map
